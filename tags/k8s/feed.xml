<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>k8s on 小惡魔 - AppleBOY</title><link>https://blog.wu-boy.com/tags/k8s/</link><description>Recent content in k8s on 小惡魔 - AppleBOY</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><managingEditor>appleboy.tw@gmail.com (Appleboy)</managingEditor><webMaster>appleboy.tw@gmail.com (Appleboy)</webMaster><lastBuildDate>Tue, 10 Oct 2017 16:02:23 +0000</lastBuildDate><atom:link href="https://blog.wu-boy.com/tags/k8s/feed.xml" rel="self" type="application/rss+xml"/><item><title>Drone 搭配 Kubernetes 升級應用程式版本</title><link>https://blog.wu-boy.com/2017/10/upgrade-kubernetes-container-using-drone/</link><pubDate>Tue, 10 Oct 2017 16:02:23 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2017/10/upgrade-kubernetes-container-using-drone/</guid><description>&lt;p>&lt;a href="https://www.flickr.com/photos/appleboy/36944908123/in/dateposted-public/" title="Screen Shot 2017-10-10 at 9.22.48 PM">&lt;img src="https://i0.wp.com/farm5.staticflickr.com/4481/36944908123_68ecdb8139_z.jpg?w=840&amp;#038;ssl=1" alt="Screen Shot 2017-10-10 at 9.22.48 PM" data-recalc-dims="1" />&lt;/a>&lt;/p>
&lt;p>本篇要教大家如何透過 &lt;a href="https://github.com/drone/drone">Drone&lt;/a> 搭配 &lt;a href="https://kubernetes.io/">Kubernetes&lt;/a> 自動化升級 App container 版本。為什麼我只說升級 App 版本，而不是升級或調整 K8S Deployment 架構呢 (&lt;code>kubectl apply&lt;/code>)？原因是本篇會圍繞在 &lt;a href="https://github.com/honestbee">honestbee&lt;/a> 撰寫的 drone 外掛: &lt;a href="https://github.com/honestbee/drone-kubernetes">drone-kubernetes&lt;/a>，此外掛是透過 Shell Script 方式搭配 &lt;a href="https://kubernetes.io/docs/user-guide/kubectl-overview/">kubectl&lt;/a> 指令來完成升級 App 版本，可以看到程式原始碼並無用到 &lt;code>kubectl apply&lt;/code> 方式來升級，也並非用 &lt;a href="https://golang.org">Go 語言&lt;/a>搭配 k8s API 所撰寫，所以無法使用 &lt;a href="https://en.wikipedia.org/wiki/YAML">YAML&lt;/a> 方式來進行 Deployment 的升級。本篇講解的範例都可以在 &lt;a href="https://github.com/go-training/drone-nodejs-example">drone-nodejs-example&lt;/a> 內找到。底下指令就是外掛用來搭配 Drone 參數所使用。&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2">&lt;code>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1">&lt;a style="outline: none; text-decoration:none; color:inherit" href="#1">1&lt;/a>
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2">&lt;a style="outline: none; text-decoration:none; color:inherit" href="#2">2&lt;/a>
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="3">&lt;a style="outline: none; text-decoration:none; color:inherit" href="#3">3&lt;/a>
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2">&lt;code class="language-bash" data-lang="bash">$ kubectl &lt;span style="color:#658b00">set&lt;/span> image &lt;span style="color:#cd5555">\
&lt;/span>&lt;span style="color:#cd5555">&lt;/span> deployment/nginx-deployment &lt;span style="color:#cd5555">\
&lt;/span>&lt;span style="color:#cd5555">&lt;/span> &lt;span style="color:#00688b">nginx&lt;/span>=nginx:1.9.1
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item></channel></rss>
<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>MySQL on 小惡魔 - AppleBOY</title><link>https://blog.wu-boy.com/tags/mysql/</link><description>Recent content in MySQL on 小惡魔 - AppleBOY</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><managingEditor>appleboy.tw@gmail.com (Appleboy)</managingEditor><webMaster>appleboy.tw@gmail.com (Appleboy)</webMaster><lastBuildDate>Sat, 01 Feb 2020 13:38:24 +0000</lastBuildDate><atom:link href="https://blog.wu-boy.com/tags/mysql/feed.xml" rel="self" type="application/rss+xml"/><item><title>[SQL] 如何從單一資料表取得每個 key 前 n 筆資料</title><link>https://blog.wu-boy.com/2020/02/how-to-select-top-n-rows-from-each-key-in-sql/</link><pubDate>Sat, 01 Feb 2020 13:38:24 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2020/02/how-to-select-top-n-rows-from-each-key-in-sql/</guid><description>&lt;p>&lt;a href="https://lh3.googleusercontent.com/TPxdqjL5VJkLQ0FQASqErBaBMi8w6uyPZLGEQ-s6ZX9_6-JMF21n5uD6CZyc_kJ31ZTBlyevmKsjYrIZK0Ts61eqd93wqsmx66uvSVhGn4JKAWb6i_1_ClO_j4G8NQ-pR31QRrqtgu4=w1920-h1080" title="postgres">&lt;img src="https://lh3.googleusercontent.com/TPxdqjL5VJkLQ0FQASqErBaBMi8w6uyPZLGEQ-s6ZX9_6-JMF21n5uD6CZyc_kJ31ZTBlyevmKsjYrIZK0Ts61eqd93wqsmx66uvSVhGn4JKAWb6i_1_ClO_j4G8NQ-pR31QRrqtgu4=w1920-h1080" alt="postgres" title="postgres">&lt;/a>&lt;/p>
&lt;p>最近專案需求需要實現單筆資料的版本控制，所以會有一張表 (foo) 專門儲存 key 資料，而有另外一張表 (bar) 專門存 Data 資料，那在 bar 這張表怎麼拿到全部 key 的最新版本資料？底下先看看 schema 範例&lt;/p></description></item><item><title>在 Docker 偵測 MySQL 或 Postgres 是否啟動</title><link>https://blog.wu-boy.com/2016/06/server-monitoring-mysql-postgres-daemon-in-docker/</link><pubDate>Sat, 11 Jun 2016 08:42:23 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2016/06/server-monitoring-mysql-postgres-daemon-in-docker/</guid><description>&lt;p>&lt;a title="Screen Shot 2016-06-11 at 6.58.22 PM" href="https://www.flickr.com/photos/appleboy/27525281071/in/dateposted-public/" data-flickr-embed="true">&lt;img src="https://i2.wp.com/c2.staticflickr.com/8/7626/27525281071_50bc0dec77_o.png?resize=591%2C580&amp;#038;ssl=1" alt="Screen Shot 2016-06-11 at 6.58.22 PM" data-recalc-dims="1" />&lt;/a>&lt;/p>
&lt;p>監控 Service 是否存活也是 &lt;a href="http://www.ithome.com.tw/news/96861">DevOps&lt;/a> 重要的一環，此篇來紀錄在 &lt;a href="https://www.docker.com/">Docker&lt;/a> 內偵測 &lt;a href="https://www.mysql.com/">MySQL&lt;/a> 或 &lt;a href="https://www.postgresql.org/">Postgres&lt;/a> 是否已經啟動。在 Docker 自動測試內，其中一步就是建立 Database 環境，底下為測試步驟:&lt;/p></description></item><item><title>Laravel 50 個小技巧 + Laravel 5.2 新功能</title><link>https://blog.wu-boy.com/2015/12/50-laravel-tricks-and-5-2-new-feature/</link><pubDate>Fri, 04 Dec 2015 15:14:25 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2015/12/50-laravel-tricks-and-5-2-new-feature/</guid><description>&lt;p>&lt;a data-flickr-embed="true" href="https://www.flickr.com/photos/appleboy/23207680879/in/dateposted-public/" title="laravel">&lt;img src="https://i1.wp.com/farm6.staticflickr.com/5765/23207680879_9c86233e9b.jpg?resize=300%2C300&amp;#038;ssl=1" alt="laravel" data-recalc-dims="1" />&lt;/a>&lt;/p>
&lt;p>在學習 &lt;a href="http://laravel.tw/">Laravel&lt;/a> 階段，一定會天天看 &lt;a href="http://laravel.tw/docs/5.1">Laravel Documentation&lt;/a>，但是有很多小技巧是在文件內沒寫出來的，網路上找到這篇 &lt;a href="https://speakerdeck.com/willroth/50-laravel-tricks-in-50-minutes">50 Laravel Tricks in 50 Minutes&lt;/a>，寫了 50 個 Laravel 小技巧，包含了 IoC Container, Blade, Eloquent, Middleware, Routing, Commands, Queues, Events, Caching 等模組。&lt;/p></description></item><item><title>優化 Percona XtraDB Cluster for write hotspots</title><link>https://blog.wu-boy.com/2015/06/optimizing-percona-xtradb-cluster-for-write-hotspots/</link><pubDate>Sat, 20 Jun 2015 07:31:46 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2015/06/optimizing-percona-xtradb-cluster-for-write-hotspots/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/12023069753/" title="percona by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm4.staticflickr.com/3820/12023069753_de60d0c86d_m.jpg?resize=240%2C234&amp;#038;ssl=1" alt="percona" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>在 &lt;a href="https://www.percona.com/blog">Percona Blog&lt;/a> 上看到這篇 &lt;a href="https://www.percona.com/blog/2015/06/03/optimizing-percona-xtradb-cluster-write-hotspots/">Optimizing Percona XtraDB Cluster for write hotspots&lt;/a> 優化多重寫入 MySQL 的狀況，舉例來說，要計算 global counter 的時候，就會遇到很頻繁的寫入 (write hotspot)，目前是不能同時寫入資料到同一個 record，會造成 performance 降低，所以大家開始導入 &lt;a href="https://www.percona.com/software/percona-xtradb-cluster">Percona XtraDB Cluster&lt;/a> 來解決同時間寫入到同一個 record，大家都認為，搞了三台 Percona Server，可以將寫入的動作分散到其他兩台，就不會遇到 Lock 問題，但是實際上根本就不是這樣。&lt;/p></description></item><item><title>在 Debian 安裝 Percona Xtradb Cluster 5.5.34 注意事項</title><link>https://blog.wu-boy.com/2014/07/install-percona-xtradb-cluster-5-5-34-tips/</link><pubDate>Fri, 04 Jul 2014 02:29:40 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/07/install-percona-xtradb-cluster-5-5-34-tips/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/12023069753/" title="percona by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm4.staticflickr.com/3820/12023069753_de60d0c86d_m.jpg?resize=240%2C234&amp;#038;ssl=1" alt="percona" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>最近幫公司安裝新的三台機器，全部上 &lt;a href="https://www.debian.org/">Debian&lt;/a> 7.5 Server 版本，統一安裝 &lt;a href="http://www.percona.com/software/percona-xtradb-cluster">Percona Xtradb Cluster&lt;/a> 最新版本 5.5.37。設定完第一台 Node，並且透過底下指令 boot up 成第一台 PXC。&lt;/p>
&lt;div>
&lt;pre class="brush: bash; title: ; notranslate" title="">$ /etc/init.d/mysql bootstrap-pxc&lt;/pre>
&lt;/div>
&lt;p>後續第二台要啟動跟第一台進行 SST，寫到一半直接噴底下錯誤訊息&lt;/p>
&lt;blockquote>
&lt;p>WSREP_SST: [ERROR] Cleanup after exit with status:32 (20140702 10:57:28.004) WSREP_SST: [INFO] Removing the sst_in_progress file (20140702 10:57:28.006) 140702 10:57:28 [ERROR] WSREP: Process completed with error: wsrep_sst_xtrabackup &amp;ndash;role &amp;lsquo;joiner&amp;rsquo; &amp;ndash;address &amp;lsquo;192.168.1.101&amp;rsquo; &amp;ndash;auth &amp;lsquo;xxxxx:xxxxxx&amp;rsquo; &amp;ndash;datadir &amp;lsquo;/var/lib/mysql/&amp;rsquo; &amp;ndash;defaults-file &amp;lsquo;/etc/mysql/my.cnf&amp;rsquo; &amp;ndash;parent &amp;lsquo;16042&amp;rsquo;: 32 (Broken pipe) 140702 10:57:28 [ERROR] WSREP: Failed to read uuid:seqno from joiner script. 140702 10:57:28 [ERROR] WSREP: SST failed: 32 (Broken pipe)&lt;/p>
&lt;/blockquote></description></item><item><title>免費下載 Percona MySQL eBooks</title><link>https://blog.wu-boy.com/2014/05/free-download-percona-mysql-ebooks/</link><pubDate>Fri, 09 May 2014 02:24:05 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/05/free-download-percona-mysql-ebooks/</guid><description>玩 MySQL 的一定知道 Percona，這次 Percona MySQL 推出免費電子書，電子書內容是從 MySQLPerformanceBlog 裡面精心挑選文章收錄，文章內容也幾乎都是 MySQL 專家寫出來的，電子書內容包含了MySQL server, Percona Server, Percona XtraDB Cluster, MySQL performance, and MySQL troubleshooting，所有的電子書都是免費下載。
How to find bugs in MySQL InnoDB Full Text Search in MySQL 5.6 InnoDB Performance Optimization Percona XtraDB Cluster 5.6 Percona XtraDB Cluster 更多主題可以直接參考 MySQL eBooks</description></item><item><title>OSDC 2014 Talk: Introduction to Percona XtraDB Cluster and HAProxy</title><link>https://blog.wu-boy.com/2014/04/osdc-2014-talk-introduction-to-percona-xtradb-cluster-and-haproxy/</link><pubDate>Sat, 12 Apr 2014 03:26:19 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/04/osdc-2014-talk-introduction-to-percona-xtradb-cluster-and-haproxy/</guid><description>&lt;p>&lt;strong>2014.05.07 OSDC 影片檔出爐&lt;/strong>&lt;/p>
&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/12023069753/" title="percona by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm4.staticflickr.com/3820/12023069753_de60d0c86d_m.jpg?resize=240%2C234&amp;#038;ssl=1" alt="percona" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>很高興可以參加今年 &lt;a href="http://osdc.tw/2014/">2014 OSDC&lt;/a>，投了一篇 &lt;a href="http://osdc.tw/program/2014-day2-10.html#content">Introduction to Percona XtraDB Cluster and HAProxy&lt;/a>，主要介紹 &lt;a href="http://www.percona.com/software/percona-xtradb-cluster">Percona XtraDB Cluster&lt;/a> 這套 open source 軟體搭配前端 &lt;a href="http://haproxy.1wt.eu/">HAProxy&lt;/a>，底下是 Slides&lt;/p></description></item><item><title>Percona Cloud Tools for MySQL 介紹及安裝</title><link>https://blog.wu-boy.com/2014/03/quick-installation-for-percona-cloud-tools-for-mysql/</link><pubDate>Thu, 06 Mar 2014 07:53:05 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/03/quick-installation-for-percona-cloud-tools-for-mysql/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/12023069753/" title="percona by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm4.staticflickr.com/3820/12023069753_de60d0c86d_m.jpg?resize=240%2C234&amp;#038;ssl=1" alt="percona" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>&lt;a href="https://www.percona.com">Percona&lt;/a> 去年推出一套 &lt;a href="https://cloud.percona.com">Cloud Tools for MySQL&lt;/a>，藉由這套雲端服務可以幫忙分析 MySQL 系統內全部 Slow Query，並且計算出時間，畫出統計圖，此套系統目前還在 Beta 版，並且有些限制，只能開 3 個 organizations，每個 organizations 只能有 5 agents，最後資料只會保留 8 天，超過就會清除。這套系統後端是由 &lt;a href="http://golang.org/">GO Language&lt;/a> 完成，前端則是由 &lt;a href="http://angularjs.org/">AngularJS&lt;/a> 串起來，上個月 Percona 還在 &lt;a href="http://www.mysqlperformanceblog.com">MySQL Performance Blog&lt;/a> 徵求 &lt;a href="http://www.mysqlperformanceblog.com/2014/01/20/percona-hiring-go-back-end-engineer/">GO 的開發者&lt;/a>，可見 Percona 也看好此服務，大膽使用 Google 推的 GO Language。&lt;/p></description></item><item><title>Percona XtraDB Cluster 5.6 找合適 IST Donor</title><link>https://blog.wu-boy.com/2014/02/percona-xtradb-cluster-5-6-ist-and-sst/</link><pubDate>Sun, 09 Feb 2014 12:55:55 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/02/percona-xtradb-cluster-5-6-ist-and-sst/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/12023069753/" title="percona by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm4.staticflickr.com/3820/12023069753_de60d0c86d_m.jpg?resize=240%2C234&amp;#038;ssl=1" alt="percona" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>Gcache 是用來紀錄 &lt;a href="http://www.mysql.com/">MySQL&lt;/a> 最近所使用的 SQL Command，其本身是佔用記憶體空間，大小可以由 &lt;code>wsrep_provider_options&lt;/code> 定義，如果有任何 MySQL Node 重新啟動，那麼可以經由 Live Node 內的 Gcache 將尚未同步的資料補上，同步資料的方式分為兩種一種為 IST(Incremental State Transfer) 另一種為 SST(State Snapshot Transfer)，但是同步資料時，管理者無法決定同步方式。先來看看 Gcache 一些特性&lt;/p>
&lt;ul>
&lt;li>node 重新啟動，Gcache 資料會全部消失&lt;/li>
&lt;li>Gcache 大小為固定，如果超過大小，則回刪除最早資料&lt;/li>
&lt;li>選擇 Donor node 會直接忽略 Gcache 狀態&lt;/li>
&lt;li>Node 重新啟動，需要同步的資料並非在指定 Node Gcahe 內，則會啟動 SST 同步&lt;/li>
&lt;li>到目前版本為止，沒有任何方式可以知道 Gcache 狀態&lt;/li>
&lt;/ul>
&lt;p>根據以上特性可以知道，當 Node 重新啟動，很容易就執行 SST 模式，舉例子來說，當有 Node crashed 超過一個晚上，你要如何知道其他 Node 內的 Gcache 資料大於需要同步的資料量？或者是當 Cluster 內只有兩台機器，那重新啟動任何一台 Node 都會是跑 SST 同步。&lt;/p></description></item><item><title>MySQL 5.6 UUID 複製資料到 Slave Server</title><link>https://blog.wu-boy.com/2014/01/mysql-5-6-uuid-cloning-slave-server/</link><pubDate>Thu, 23 Jan 2014 03:20:08 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/01/mysql-5-6-uuid-cloning-slave-server/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/8171305355/" title="mysql_logo by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm9.staticflickr.com/8488/8171305355_7fb578fdc9.jpg?w=300&amp;#038;ssl=1" alt="mysql_logo" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>在 &lt;a href="http://www.mysqlperformanceblog.com/">MySQL Performance Blog&lt;/a> 看到這篇 &lt;a href="http://www.mysqlperformanceblog.com/2014/01/21/beware-mysql-5-6-server-uuid-cloning-slaves/">Beware of MySQL 5.6 server UUID when cloning slaves&lt;/a>，裡面提到如果是要複製資料到 Slave 機器，大部分的使用者肯定是將 &lt;code>/var/lib/mysql&lt;/code> 目錄整個 copy 到 Slave 機器上。如果是 &lt;a href="http://dev.mysql.com/tech-resources/articles/whats-new-in-mysql-5.6.html">MySQL 5.6&lt;/a> Server 目錄內會有 &lt;code>auto.cnf&lt;/code> 設定檔，這是 MySQL 5.6 新的功能叫做 &lt;a href="http://dev.mysql.com/doc/refman/5.6/en/replication-options.html#sysvar_server_uuid">server_uuid&lt;/a>，在啟動 MySQL 後，就會自動建立 &lt;code>auto.cnf&lt;/code> 檔案，此檔案就像是 &lt;code>my.cnf&lt;/code> 或 &lt;code>my.ini&lt;/code> 設定檔一樣，只是內容只有支援 &lt;code>[auto]&lt;/code> 並且只有支援 &lt;code>server_uuid&lt;/code> 這 key 值，例如&lt;/p></description></item><item><title>啟動 Percona XtraDB Cluster 注意事項</title><link>https://blog.wu-boy.com/2014/01/start-percona-xtradb-cluster-tips/</link><pubDate>Mon, 20 Jan 2014 06:50:45 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/01/start-percona-xtradb-cluster-tips/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/12023069753/" title="percona by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm4.staticflickr.com/3820/12023069753_de60d0c86d_m.jpg?resize=240%2C234&amp;#038;ssl=1" alt="percona" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>在 &lt;a href="http://www.percona.com/software/percona-xtradb-cluster">Percona XtraDB Cluster&lt;/a> 推出 &lt;a href="http://www.percona.com/doc/percona-xtradb-cluster/5.5/release-notes/Percona-XtraDB-Cluster-5.5.28.html">5.5.28&lt;/a> 以前，最簡單的啟動方式就是打開 &lt;code>my.cnf&lt;/code> 設定 &lt;code>wsrep_urls&lt;/code> 在 &lt;code>[mysqld_safe]&lt;/code> section 內。假設我們有三台 Node 分別為底下 IP:&lt;/p>
&lt;ul>
&lt;li>node1 = 192.168.1.100&lt;/li>
&lt;li>node2 = 192.168.1.101&lt;/li>
&lt;li>node3 = 192.168.1.102&lt;/li>
&lt;/ul></description></item><item><title>Percona XtraDB Cluster 搭配 HAProxy</title><link>https://blog.wu-boy.com/2014/01/percona-xtradb-cluster-reference-architecture-with-haproxy/</link><pubDate>Sun, 19 Jan 2014 13:02:47 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/01/percona-xtradb-cluster-reference-architecture-with-haproxy/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/12023069753/" title="percona by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm4.staticflickr.com/3820/12023069753_de60d0c86d_m.jpg?resize=240%2C234&amp;#038;ssl=1" alt="percona" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>本篇文章紀錄安裝 &lt;a href="http://www.percona.com/software/percona-xtradb-cluster">Percona XtraDB Cluster&lt;/a> (簡稱 PXC) 及搭配 &lt;a href="http://haproxy.1wt.eu/">HAProxy&lt;/a> 做分散流量系統，其實在業界已經很常看到 HAProxy + MySQL Cluster Database 解決方案，HAProxy 幫您解決負載平衡，並且偵測系統是否存活，管理者也就不用擔心 MySQL 服務是否會掛掉。本篇會著重於 HAProxy 設定部份，並且紀錄每一步安裝步驟。之前本作者寫過一篇 &lt;a href="http://blog.wu-boy.com/2013/03/galera-cluster-for-mysql-multi-master-replication/">Galera Cluster for MySQL Multi-master Replication&lt;/a>，也可以參考。今天測試系統都會以 &lt;a href="http://www.centos.org/">CentOS&lt;/a> 為主，各位讀者可以直接開 &lt;a href="http://aws.amazon.com/ec2/">Amazone EC2&lt;/a> 來測試，測試完成再關閉即可。&lt;/p></description></item><item><title>Percona XtraDB Server 出現 read only issue</title><link>https://blog.wu-boy.com/2014/01/percona-xtradb-server-read-only-issue/</link><pubDate>Thu, 16 Jan 2014 08:25:42 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/01/percona-xtradb-server-read-only-issue/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/8171305355/" title="mysql_logo by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm9.staticflickr.com/8488/8171305355_7fb578fdc9.jpg?w=300&amp;#038;ssl=1" alt="mysql_logo" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>最近在整理 &lt;a href="http://www.percona.com/software/percona-server">Percona XtraDB Server&lt;/a> 將 Read Write 全部拆開，寫入部份只開一台 Node，讀取機器 Replica 則是越多越好，當然如果預計 write 都不會有任何 conflict 的話，那就不用拆開，read write 都可以在同一台即可，拆開的目的要解決 &lt;code>Innodb transaction locking&lt;/code> 問題。今天遇到的是將機器讀寫都放在同一台，然後同時多台 Master 架構，結果跑在 &lt;a href="http://www.codeigniter.org.tw/">CodeIgniter&lt;/a> 上面出現底下錯誤訊息&lt;/p>
&lt;blockquote>
&lt;p>The MySQL server is running with the &amp;ndash;read-only option so it cannot execute this statement&lt;/p>
&lt;/blockquote></description></item><item><title>Sysbench 測試 Percona XtraDB Server 效能</title><link>https://blog.wu-boy.com/2014/01/sysbench-test-percona-xtradb-server-performance/</link><pubDate>Wed, 15 Jan 2014 11:00:15 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/01/sysbench-test-percona-xtradb-server-performance/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/8171305355/" title="mysql_logo by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm9.staticflickr.com/8488/8171305355_7fb578fdc9.jpg?w=300&amp;#038;ssl=1" alt="mysql_logo" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>今天拿 &lt;a href="https://launchpad.net/sysbench">MySQL benchmark tool - Sysbench&lt;/a> 來測試看看 &lt;a href="http://www.percona.com/software/percona-server">Percona XtraDB Server&lt;/a> + &lt;a href="http://haproxy.1wt.eu/">Haproxy&lt;/a> 效能如何，實驗主機是執行在 &lt;a href="http://www.centos.org/">CentOS&lt;/a> 6.4 版本，記憶體 128 G，在 CentOS 本身用 Yum 安裝 Sysbench 時，內建的版本為 0.4.12，單機測試 MySQL 效能不會出現任何錯誤，但是只要是透過 Haproxy，並且有兩台以上的 Server，就會噴出底下錯誤訊息:&lt;/p>
&lt;blockquote>
&lt;p>ALERT: failed to execute mysql_stmt_execute(): Err1317 Query execution was interrupted&lt;/p>
&lt;/blockquote></description></item><item><title>How to install Gearman on Ubuntu or Debian with MySQL 安裝測試篇</title><link>https://blog.wu-boy.com/2013/06/how-to-install-gearman-on-ubuntu-or-debian-with-mysql/</link><pubDate>Thu, 13 Jun 2013 09:31:40 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2013/06/how-to-install-gearman-on-ubuntu-or-debian-with-mysql/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;img src="https://i2.wp.com/gearman.org/_media/:wiki:logo.png?w=840" alt="" data-recalc-dims="1" />
&lt;/div>
&lt;p>&lt;a href="http://gearman.org/" target="_blank">Gearman&lt;/a> 可以在背景幫忙處理繁瑣的工作，例如壓縮影片、處理縮圖、發送認證信…等，這次不會提到太多 Gearman 介紹，如果想瞭解 Gearman 可以參考&lt;a href="http://www.jaceju.net/" target="_blank">小鐵兄&lt;/a>寫的 &lt;a href="http://www.jaceju.net/blog/archives/1211/" target="_blank">Gearman 心得&lt;/a>，此篇會筆記如何在 Ubuntu or Debian 安裝 Gearman 搭配 MySQL 服務，當然如果你不是使用 MySQL，也可以另外搭配 &lt;a href="http://memcached.org/" target="_blank">Memcached&lt;/a> 或 &lt;a href="http://www.sqlite.org/" target="_blank">SQLite&lt;/a> 都可以&lt;/p></description></item><item><title>Nginx + phpMyAdmin 搭配 SSL 設定</title><link>https://blog.wu-boy.com/2013/06/force-phpmyadmin-ssl-with-nginx/</link><pubDate>Sat, 08 Jun 2013 07:51:08 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2013/06/force-phpmyadmin-ssl-with-nginx/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/8171305355/" title="mysql_logo by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm9.staticflickr.com/8488/8171305355_7fb578fdc9.jpg?w=300&amp;#038;ssl=1" alt="mysql_logo" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>&lt;a href="http://www.phpmyadmin.net/home_page/index.php" target="_blank">phpMyAdmin&lt;/a> 是一套用來管理 &lt;a href="http://www.mysql.com/" target="_blank">MySQL&lt;/a> 的 Web 介面，如果要讓 phpMyAdmin 強制走 https 的話，可以透過兩種方式，一種是直接設定 phpMyAdmin，另外一種方式是透過 &lt;a href="http://httpd.apache.org/docs/current/mod/mod_rewrite.html" target="_blank">Apache rewrite&lt;/a> 或 &lt;a href="http://nginx.org/" target="_blank">Nginx&lt;/a> 設定，底下來分別說明。&lt;/p></description></item><item><title>MySQL 用 MySQLDump 備份 InnoDB 注意事項</title><link>https://blog.wu-boy.com/2013/04/best-mysqldump-innodb-data/</link><pubDate>Fri, 05 Apr 2013 02:20:22 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2013/04/best-mysqldump-innodb-data/</guid><description>大家在備份 MySQL 資料庫時一定是使 mysqldump 指令，不管是 MyISAM 或 InnoDB 都一樣， 在處理 InnoDB 格式備份時使用 mysqldump -single-transaction，但是你會發現在大多的備份狀況都是 OK 的，只是有時候會發現有的資料表只有備份到 structure 而無備份到 Data？ 在 MySQL Performance Blog 看到這篇講解 Best kept MySQLDump Secret，此問題出在 how MySQL’s Transactions work with DDL，ALTER TABLE 會建立一個 temporary table，並且將該資料表資料複製過去，接著刪除原有資料表，最後將 temporary table 命名為原來資料表。 底下是原作者提到的原因
How does data visibility works in this case ? DDLs are not transactional and as such the running transaction will not see the contents of old table once it is dropped, transaction also will see the new table which was created after transaction was started, including table created by ALTER TABLE statement.</description></item><item><title>Galera Cluster for MySQL Multi-master Replication</title><link>https://blog.wu-boy.com/2013/03/galera-cluster-for-mysql-multi-master-replication/</link><pubDate>Sun, 31 Mar 2013 04:48:55 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2013/03/galera-cluster-for-mysql-multi-master-replication/</guid><description>&lt;div style="margin: 0 auto; text-align: center;">
&lt;a title="galera_mysql_replication by appleboy46, on Flickr" href="https://www.flickr.com/photos/appleboy/8603447002/">&lt;img alt="galera_mysql_replication" src="https://i0.wp.com/farm9.staticflickr.com/8383/8603447002_050ecd1b53.jpg?resize=500%2C247&amp;#038;ssl=1" data-recalc-dims="1" />&lt;/a>
&lt;/div> 最近公司買了幾台機架伺服器來處理 HTTP 跟 DB Load balancer，要做到 DB 的分散式架構，首先需要同步多台機器資料，也就是寫入或更動任意一台單筆資料，另外平行的機器也會同時進行更新。同步的好處可以用來做備援及分散處理連線，而要做到此功能，可子參考網路上評價不錯的
&lt;p>&lt;a href="http://www.codership.com/content/using-galera-cluster" target="_blank">Galera Cluster for MySQL&lt;/a> 方案。本篇會介紹在 &lt;a href="http://www.ubuntu.com/" target="_blank">Ubuntu&lt;/a> 或 &lt;a href="http://www.centos.org/" target="_blank">CentOS&lt;/a> 6.x final 版本如何安裝 Galera 伺服器套件及設定。要架設 Galera Cluster Server，有兩種套件選擇，一個是 &lt;a href="http://www.percona.com/software/percona-xtradb-cluster" target="_blank">Percona XtraDB Cluster&lt;/a> 另一個是 &lt;a href="https://downloads.mariadb.org/mariadb-galera/" target="_blank">MariaDB Galera Cluster&lt;/a>，這次作者會介紹後者的安裝。&lt;/p>
&lt;h3 id="galera-cluster-介紹-為什麼要選擇-galera-cluster-server它有什麼優點及功能呢mysqlgalera-是一套可以同步多台-mysqlinnodb-機器的叢集系統底下可以列出功能">Galera Cluster 介紹 為什麼要選擇 Galera Cluster Server，它有什麼優點及功能呢？MySQL/Galera 是一套可以同步多台 MySQL/InnoDB 機器的叢集系統，底下可以列出功能。&lt;/h3>
&lt;ul>
&lt;li>同步複製資料&lt;/li>
&lt;li>可讀取和寫入叢集系統內任一節點&lt;/li>
&lt;li>自動偵測節點錯誤，如果有節點當機，則叢集系統自動移除該節點&lt;/li>
&lt;li>可任意擴充節點&lt;/li>
&lt;li>採用 row level 方式來平行複製資料 從上面功能看來，我們可以平行任意擴充節點，動態增加伺服器到叢集系統，要做到上面功能，就是利用&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="http://www.codership.com/products/galera_replication" target="_blank">Galera library&lt;/a> 來做到同步資料處理，同步的詳細細節，可以參考 Galera library 連結。這邊就不再多描述了。&lt;/p></description></item><item><title>Percona XtraBackup InnoDB 備份工具</title><link>https://blog.wu-boy.com/2013/01/percona-xtrabackup-innodb/</link><pubDate>Tue, 01 Jan 2013 04:13:33 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2013/01/percona-xtrabackup-innodb/</guid><description>&lt;p>&lt;a href="http://www.percona.com/software/percona-xtrabackup/" target="_blank">Percona XtraBackup&lt;/a> 是一套 compiled C 程式，用於備份 MySQL InnoDB 資料庫，過去備份 MyISAM 或 InnoDB 都是透過 mysqldump 指令，或者是直接 copy &lt;strong>&lt;span style="color: #008000;">/var/lib/mysql&lt;/span>&lt;/strong> 目錄當作備份(這方法盡量少做，請確定 MySQL 版本一致)，XtraBackup 用於備份 InnoDB 資料部份，請注意這邊，真的只有&amp;quot;備份資料&amp;quot;，而不是全部(結構跟資料)，底下仔細介紹如何安裝:&lt;/p>
&lt;h3 id="安裝方式-大家可以選擇透過">安裝方式 大家可以選擇透過&lt;/h3>
&lt;p>&lt;a href="http://www.percona.com/doc/percona-xtrabackup/installation/yum_repo.html" target="_blank">yum&lt;/a> 或 &lt;a href="http://www.percona.com/doc/percona-xtrabackup/installation/apt_repo.html" target="_blank">apt&lt;/a> Repository 方式安裝，下面介紹 apt 方式即可。&lt;/p></description></item><item><title>MySQL MyISAM Engine 轉換成 InnoDB</title><link>https://blog.wu-boy.com/2012/12/mysql-myisam-tables-convert-to-innodb/</link><pubDate>Sat, 15 Dec 2012 02:50:04 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2012/12/mysql-myisam-tables-convert-to-innodb/</guid><description>&lt;div style="margin: 0 auto; text-align: center;">
&lt;img src="https://i2.wp.com/farm9.staticflickr.com/8488/8171305355_db09e220a4_o.png?w=840&amp;#038;ssl=1" alt="" data-recalc-dims="1" />
&lt;/div> 如果對於 InnoDB 不了解的讀者們，可以參考作者之前寫的
&lt;p>&lt;a href="http://blog.wu-boy.com/2012/11/innodb-as-the-default-mysql-storage-engine/" target="_blank">MySQL 預設儲存引擎: InnoDB 介紹&lt;/a>，最近開始把原本 &lt;a href="http://dev.mysql.com" target="_blank">MySQL&lt;/a> 5.1 預設 &lt;a href="http://dev.mysql.com/doc/refman/5.5/en/myisam-storage-engine.html" target="_blank">MyISAM&lt;/a> Table 全部轉換成 &lt;a href="http://dev.mysql.com/doc/refman/5.5/en/innodb-storage-engine.html" target="_blank">InnoDB&lt;/a>，MySQL 5.5 版本開始預設的儲存引擎就是 InnoDB，InnoDB 現在也非常完整，也支援 Full Text (5.6.4 開始支援)。作者在轉換過程其實蠻順利的，步驟也不是很複雜，只要按底下步驟，就可以順利轉換。&lt;/p></description></item><item><title>MySQL 預設儲存引擎: InnoDB 介紹</title><link>https://blog.wu-boy.com/2012/11/innodb-as-the-default-mysql-storage-engine/</link><pubDate>Sat, 10 Nov 2012 09:00:02 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2012/11/innodb-as-the-default-mysql-storage-engine/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/8171305355/" title="mysql_logo by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm9.staticflickr.com/8488/8171305355_7fb578fdc9.jpg?resize=489%2C253&amp;#038;ssl=1" alt="mysql_logo" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>&lt;a href="http://www.mysql.com" target="_blank">MySQL&lt;/a> 是一套眾所皆知的 Database System，今天來簡介 &lt;a href="http://dev.mysql.com/doc/refman/5.5/en/myisam-storage-engine.html" target="_blank">InnoDB&lt;/a> 儲存引擎，在 MySQL 5.5.5 之前預設的儲存引擎是 &lt;a href="https://dev.mysql.com/doc/refman/5.5/en/myisam-storage-engine.html" target="_blank">MyISAM&lt;/a>，但是為什麼在 5.5 之後官方要將預設儲存引擎換成 InnoDB 呢？大家都知道 InnoDB 用來交易管理非常方便，因為 InnoDB 透過 row lock，相對於 &lt;a href="http://dev.mysql.com/doc/refman/5.5/en/myisam-storage-engine.html" target="_blank">MyISAM&lt;/a> 透過 table lock 來的有效率，也避免大量寫入的時候，造成無法讀取資料，這就是 row lock 的優勢，當然用 InnoDB 最主要的原因還有 Full-text search indexes 功能，但是別擔心 MySQL 5.6.4 之後(含此版本) InnoDB 開始支援 Full-text search 功能，另外在使用 MyISAM 時候，如果資料突然出問題，還必須使用 &lt;a href="http://dev.mysql.com/doc/refman/5.0/en/binary-log.html" target="_blank">MySQL Binary Log&lt;/a> 來恢復資料，如果用 InnoDB 這就沒關係了。大家還在用 MyISAM 嘛？開始升級伺服器，一起體驗 InnoDB 的功能，如果已經上線很久的網站，作者不建議轉換，因為可能會遇到很多雷。&lt;/p></description></item><item><title>PHP 將長期宣導程式設計師將 ext/mysql 改用 pdo_mysql 和 mysqli</title><link>https://blog.wu-boy.com/2011/07/php-%E5%B0%87%E9%95%B7%E6%9C%9F%E5%AE%A3%E5%B0%8E%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88%E5%B8%AB%E5%B0%87-extmysql-%E6%94%B9%E7%94%A8-pdo_mysql-%E5%92%8C-mysqli/</link><pubDate>Mon, 18 Jul 2011 02:50:36 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2011/07/php-%E5%B0%87%E9%95%B7%E6%9C%9F%E5%AE%A3%E5%B0%8E%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88%E5%B8%AB%E5%B0%87-extmysql-%E6%94%B9%E7%94%A8-pdo_mysql-%E5%92%8C-mysqli/</guid><description> 今天看到一篇 PHP-Dev 公佈一篇 [PHP-DEV] deprecating ext/mysql，大意就是 PHP 官方未來將打算移除 ext/mysql 的所有相關文件及功能，作者相信很多程式開發者都是用 mysql 套件下去開發，聽到這消息會非常錯愕吧。 官方 documentation team 討論移除的原因在於安全性的考量，在 DK 大神那邊看到是使用 ext/mysql 必須自己處理 mysql_real_escape_string 和 mysql_escape_string，所以官方希望教育使用者不要再使用 ext/mysql 了，底下是官方會做的事情
增加說明指出 ext/mysql 已過時 建議和取代方案 包含取代方案的範例 官方提供了兩個解決方案 pdo_mysql 和 mysqli，官方列了幾點說明：
從現在開始教育使用者及增加說明文件 在 5.4 版本增加 E_DEPRECATED 訊息，甚至 5.5 6.0 都可以 提供 pdo_mysql 轉換的說明文件 專注於整理 pdo_mysql 跟 mysqli 的線上文件 增加 &amp;ldquo;The MySQL situation&amp;rdquo; 的文件說明現況 看完這篇，大家現在趕快轉換到 mysqli 或者是使用 PDO 來開發程式吧</description></item><item><title>2011 OSDC Day 1 筆記</title><link>https://blog.wu-boy.com/2011/03/2011-osdc-day-1-%E7%AD%86%E8%A8%98/</link><pubDate>Thu, 31 Mar 2011 12:55:56 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2011/03/2011-osdc-day-1-%E7%AD%86%E8%A8%98/</guid><description>Update: 補上 OSDC 紀錄影片 2011.06.26 今年很高興可以北上參加 OSDC 2011 (Open Source Developers Conference)，由於之前都在南部唸書及工作，沒有機會北上參加聚會，現在人在新竹，終於有機會可以參加了，雖然早上六點就要起床趕電車了，不過到現場聽課感覺就是不同，也可以認識很多新朋友，底下來紀錄上課筆記
微軟與 jQuery 社群的親密接觸 講者: Eric Shangkuan (Microsoft) Slide: 微軟與 jQuery 社群的親密接觸 這是 OSDC 第一場演講，早上九點就開始了，雖然人不多，但是蠻多人還是為了講者而來，首先介紹什麼是 jQuery，以及 jQuery 一些基本用法，像是 CSS selector，如何在 Windows Visual Studio 上面開發 jQuery 及撰寫 plugin 整合進去 ASP.Net，最後介紹三個不錯用的 jQuery Plugin: Templeate, Datalink, Globalzation。
Templeate: 這搭配 Facebook api 可以直接做個人頁面，請參考這裡 Globalzation: 前端多國語系實做 Datalink: 可以快速處理 form，利用 object 跟 jQuery 搭配 如果要研究上述三個 jQuery Plugin 可以參考底下: jQuery Datalink: https://github.com/jquery/jquery-datalink jQuery Templeate: https://github.com/jquery/jquery-tmpl jQuery Globalzation: https://github.</description></item><item><title>[資料庫] 如何轉換 Mysql varchar type 到 int type</title><link>https://blog.wu-boy.com/2010/12/%E8%B3%87%E6%96%99%E5%BA%AB-%E5%A6%82%E4%BD%95%E8%BD%89%E6%8F%9B-mysql-varchar-type-%E5%88%B0-int-type/</link><pubDate>Fri, 17 Dec 2010 06:14:23 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2010/12/%E8%B3%87%E6%96%99%E5%BA%AB-%E5%A6%82%E4%BD%95%E8%BD%89%E6%8F%9B-mysql-varchar-type-%E5%88%B0-int-type/</guid><description>&lt;p>先來說明為什麼有時候需要用到轉換 varchar 到 int 型態，就是因為 order by 的問題，幫學校修改 Mysql 錯誤排序，前人設計全部都用 varchar 型態去存資料，當然包含了學生入學年度，以前不會遇到這問題，但是到了民國100年，就會發生排序錯誤，底下來講個例子，這樣大家就可以瞭解了。 建立 test 資料表，並且先增兩個欄位分別是 a(&lt;span style="color:red">&lt;strong>varchar&lt;/strong>&lt;/span>) 跟 b(&lt;span style="color:green">&lt;strong>int&lt;/strong>&lt;/span>)，個別輸入 100, 90 兩列資料&lt;/p>
&lt;pre class="brush: bash; title: ; notranslate" title="">mysql> select * from test;
+------+------+
| a | b |
+------+------+
| 100 | 100 |
| 90 | 90 |
+------+------+
&lt;/pre> 先針對 varchar 排序 order by a DESC
&lt;pre class="brush: bash; title: ; notranslate" title="">mysql> select * from test order by a desc;
+------+------+
| a | b |
+------+------+
| 90 | 90 |
| 100 | 100 |
+------+------+&lt;/pre> 再來針對 int 排序 order by b DESC
&lt;pre class="brush: bash; title: ; notranslate" title="">mysql> select * from test order by b desc;
+------+------+
| a | b |
+------+------+
| 100 | 100 |
| 90 | 90 |
+------+------+&lt;/pre></description></item><item><title>[網站] 好站連結 (七) Android, javascript, Css, PHP, Perl, FreeBSD, Linux</title><link>https://blog.wu-boy.com/2010/07/%E7%B6%B2%E7%AB%99-%E5%A5%BD%E7%AB%99%E9%80%A3%E7%B5%90-%E4%B8%83-android-javascript-css-php-perl-freebsd-linux/</link><pubDate>Fri, 30 Jul 2010 14:53:46 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2010/07/%E7%B6%B2%E7%AB%99-%E5%A5%BD%E7%AB%99%E9%80%A3%E7%B5%90-%E4%B8%83-android-javascript-css-php-perl-freebsd-linux/</guid><description>Windows C#
C# 比較字串 MSDN 比較字串 Request.Form Collection Request Query String / Form Parametrs ASP.NET QueryString Usage Using include files with ASP.NET html
[將所有 的內容包到一個
中][7] apache
Fixing mod_rewrite and .htaccess on GoDaddy Hosting javascript
jQuery Week Calendar Javascript: reference the parent window from a popup How to get and set form element values with jQuery How to check and uncheck a checkbox with jQuery Loop through parameters passed to a Javascript function perl-completion.</description></item><item><title>[FreeBSD] update apache -> 2.2.15, PHP -> 5.3.2, and MySQL downgrade to 5.1.9</title><link>https://blog.wu-boy.com/2010/06/freebsd-update-apache-2-2-15-php-5-3-2-and-mysql-downgrade-to-5-1-9/</link><pubDate>Wed, 23 Jun 2010 05:46:34 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2010/06/freebsd-update-apache-2-2-15-php-5-3-2-and-mysql-downgrade-to-5-1-9/</guid><description>昨天升級了 FreeBSD 的 Apache, PHP, and MySQL，遇到很多地雷阿，最多的就是 PHP 的部份，因為本來自己使用 5.2.11 版本，但是在 commit port 的時候發生去裝 5.3.2 版本，所以就直接砍掉全部重練，先是遇到 MySQL 問題，原先在 database/mysql60-server 已經被 FreeBSD 移除，任何關於 mysql60 的相關 port 都被 remove 掉了，只好 downgrade 到 mysql 5.1.48 版本，移除同時順手把 apache PHP 相關都拿掉了。
移除 apache mysql php 相關 ports -rf 依序找尋相關 Mysql ports 移除 pkg_deinstall -rf mysql60-server 接下來安裝 MySQL 5.1.48 Server and Client，可以找到在 databases/mysql51-server and databases/mysql51-client，直接安裝即可
cd /usr/ports/databases/mysql51-server &amp;&amp; make install 安裝 Apache 2.2.15 cd /usr/ports/www/apache22 &amp;&amp; make WITH_MPM=worker install 安裝 PHP 5.</description></item><item><title>[MySQL] 必要修正一些預設值 (performance tunning)</title><link>https://blog.wu-boy.com/2009/11/mysql-%E5%BF%85%E8%A6%81%E4%BF%AE%E6%AD%A3%E4%B8%80%E4%BA%9B%E9%A0%90%E8%A8%AD%E5%80%BC-performance-tunning/</link><pubDate>Fri, 20 Nov 2009 04:47:06 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2009/11/mysql-%E5%BF%85%E8%A6%81%E4%BF%AE%E6%AD%A3%E4%B8%80%E4%BA%9B%E9%A0%90%E8%A8%AD%E5%80%BC-performance-tunning/</guid><description>參考了一篇：『Fixing Poor MySQL Default Configuration Values』，裡面提到了四個 MySQL 預設值相當沒有意義，所以 Jeremy Zawodny 提出了修改，也解釋了為什麼這四個會降低 MySQL 的效能。 1. max_connect_errors: 當使用者連接 MySQL 出現錯誤，伺服器就會根據 connect_timeout 所設定時間之後，而放棄等待，放棄之後會有 counter 來紀錄連接失敗的次數，當達到 max_connect_errors 設定值，伺服器就會 locked out client 端，這會衍生一個問題，那就是可以惡搞同一台網站，把 MySQL 搞爛，造成封鎖，不過解決方法就是把 max_connect_errors 設定成 (max_connect_errors=1844674407370954751) 2. connect_timeout: 這跟上面 max_connect_errors 是有相當大的關係，MySQL 預設 connect_timeout 是五秒，可是在網路繁忙的時候，也許需要花費比較多的時間來做連接， 但是預設值是五秒的話，這樣會一直 time out，造成 counter 持續增加，屆時會超過 max_connect_errors 設定值，所以必須把 connect_timeout 設定提高到 15 or 20，這樣就可以了 (connect_timeout = 20) 3. skip-name-resolve: 在每次的 MySQL 連線，伺服器端會偵測 Client 的 DNS 反解，這步驟真的有點多餘 綜合上面結論，請加入 my.cnf 一些設定
max_connect_errors = 1844674407370954751
connect_timeout = 20
skip-name-resolve
slave_net_timeout = 30 Reference: 無論如何都應該修改的 MySQL 預設值 線上環境的 MySQL 預設值修改(Jeremy 建議)</description></item><item><title>[講義]屏科大 PHP &amp; MySQL 基礎教學投影片</title><link>https://blog.wu-boy.com/2009/10/%E8%AC%9B%E7%BE%A9%E5%B1%8F%E7%A7%91%E5%A4%A7-php-mysql-%E5%9F%BA%E7%A4%8E%E6%95%99%E5%AD%B8%E6%8A%95%E5%BD%B1%E7%89%87/</link><pubDate>Sat, 17 Oct 2009 17:10:59 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2009/10/%E8%AC%9B%E7%BE%A9%E5%B1%8F%E7%A7%91%E5%A4%A7-php-mysql-%E5%9F%BA%E7%A4%8E%E6%95%99%E5%AD%B8%E6%8A%95%E5%BD%B1%E7%89%87/</guid><description>這次非常開心受到國立屏東科技大學資管系邀請講課，主題是 PHP &amp;amp; MySQL 基礎介紹，來聽課的學生，就是資管系大三跟碩一的新生，第一次到屏科大，沒想到學校大到很誇張阿，在校園裡面都是騎機車上課，不像在東華大學，只能騎外環道，剩下的只能騎腳踏車，屏科大其實蠻偏僻的，離屏東市有一段距離，大概騎摩托車要 20 分鐘，至少今天回家是被用摩托車送到屏東火車站，感覺屏東還蠻熱鬧的。
這些資管的學生還蠻認真的，基礎實力還不錯，不過還是要在加強一下，看屏科大資管都在學 ASP.net，對於 html 有些基礎，大家好像都蠻喜歡拉物件，說這樣寫程式還蠻快的，不過 PHP 好像沒有類似工具，今天上課蠻順利的，至少大家都聽的懂，課堂作業都有寫出來，還蠻開心的，想聽聽大家對我上課的意見，看來只好等下次上課在問問看他們。</description></item><item><title>利用 PHP MySQL Quota-Tool 來限制 MySQL 存取空間大小</title><link>https://blog.wu-boy.com/2009/10/%E5%88%A9%E7%94%A8-php-mysql-quota-tool-%E4%BE%86%E9%99%90%E5%88%B6-mysql-%E5%AD%98%E5%8F%96%E7%A9%BA%E9%96%93%E5%A4%A7%E5%B0%8F/</link><pubDate>Fri, 09 Oct 2009 04:17:37 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2009/10/%E5%88%A9%E7%94%A8-php-mysql-quota-tool-%E4%BE%86%E9%99%90%E5%88%B6-mysql-%E5%AD%98%E5%8F%96%E7%A9%BA%E9%96%93%E5%A4%A7%E5%B0%8F/</guid><description>&lt;p>在&lt;a href="http://phorum.study-area.org">酷！學園&lt;/a>發現&lt;a href="http://phorum.study-area.org/index.php/topic,58445.0.html">這篇&lt;/a>，有人問到如何限制 MySQL 的使用空間大小，我第一個想到的就是 &lt;a href="http://linux.vbird.org/linux_basic/0420quota.php">Linux quota&lt;/a> 指令限制大小，看回文有一篇利用 MySQL 來解決此問題：&lt;a href="http://projects.marsching.org/mysql_quota/">MySQL Quota-Tool&lt;/a>，它利用了 MySQL INSERT 跟 CREATE 的權限控管，來達成限制，當資料庫大小超過您所設定的限制，系統就會拔除您的 INSERT 跟 CREATE 權限，如果沒有超過，就會將權限設定回去，基本上非常簡單，首先要先建立一個專屬控管每個資料庫的 database&lt;/p>
&lt;pre class="brush: sql; title: ; notranslate" title="">CREATE TABLE `Quota` (`Db` CHAR(64) NOT NULL,
`Limit` BIGINT NOT NULL,
`Exceeded` ENUM('Y','N') DEFAULT 'N' NOT NULL,
PRIMARY KEY (`Db`), UNIQUE (`Db`));&lt;/pre></description></item><item><title>[網站] 好站連結 (四)</title><link>https://blog.wu-boy.com/2009/07/%E7%B6%B2%E7%AB%99-%E5%A5%BD%E7%AB%99%E9%80%A3%E7%B5%90-%E5%9B%9B/</link><pubDate>Tue, 28 Jul 2009 07:00:59 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2009/07/%E7%B6%B2%E7%AB%99-%E5%A5%BD%E7%AB%99%E9%80%A3%E7%B5%90-%E5%9B%9B/</guid><description>PHP
How to create Microsoft Office Documents with PHP
IP 判斷方式
Get a list of all available constants with PHP
Get a list of all available classes with PHP
Get a list of all available functions with PHP
The Google Analytics API and PHP: A series
Google Analytics API PHP Class data method parameters
Dynamically Create Menu With PHP DOM
Enable the file manager connector with FCKEditor and PHP MySQL</description></item><item><title>[SQL] MySQL ROW_NUMBER Simulation</title><link>https://blog.wu-boy.com/2009/07/sql-mysql-row_number-simulation/</link><pubDate>Wed, 15 Jul 2009 02:48:34 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2009/07/sql-mysql-row_number-simulation/</guid><description>&lt;p>在台大 &lt;a href="http://www.ptt.cc/bbs/Database/index.html">PTT Database&lt;/a> 版看到有人問一個問題，我覺得還不錯，問題如下：&lt;a href="http://www.ptt.cc/bbs/Database/M.1247394036.A.A50.html">網頁版&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>小弟在練習做一個系統遇到以下問題 志願 | 系所 | 功能 1 | a | 退選 2 | b | 退選 3 | c | 退選 4 | d | 退選 5 | e | 退選 網頁介面如上(用for迴圈+mysql_fetch_object抓出資料) 報名序號 | 姓名 | 志願1 | 志願2 | 志願3 | 志願4 | 志願5 1001 小王 a b c d e 資料庫欄位內容如上 想請問~若使用者想退選志願3~~照理說用update把志願3欄位清掉 網頁再一次抓資料會變成志願3的系所變空的~(如下表) 志願 | 系所 | 功能 1 | a | 退選 2 | b | 退選 3 | | 退選 4 | d | 退選 5 | e | 退選 有沒有辦法在select的時候排除空的那欄 也就是說抓資料的時候，以上述為例，只抓出4筆，變成下表 志願 | 系所 | 功能 1 | a | 退選 2 | b | 退選 3 | d | 退選 4 | e | 退選&lt;/p>
&lt;/blockquote></description></item><item><title>[MySQL] 利用 perl 單行印出 my.cnf</title><link>https://blog.wu-boy.com/2009/06/mysql-%E5%88%A9%E7%94%A8-perl-%E5%96%AE%E8%A1%8C%E5%8D%B0%E5%87%BA-mycnf/</link><pubDate>Wed, 17 Jun 2009 13:36:21 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2009/06/mysql-%E5%88%A9%E7%94%A8-perl-%E5%96%AE%E8%A1%8C%E5%8D%B0%E5%87%BA-mycnf/</guid><description>在 MySQL Performance Blog 裡面發現這篇：How to pretty-print my.cnf with a one-liner，利用一行 perl 指令把 my.cnf 的註解拿掉：
perl -ne 'm/^([^#][^\s=]+)\s*(=.*|)/ &amp;&amp; printf("%-35s%s\n", $1, $2)' /etc/my.cnf 輸出為： [client]
port = 3306
socket = /tmp/mysql.sock
[mysqld]
port = 3306
socket = /tmp/mysql.sock
skip-locking
key_buffer = 256M
max_allowed_packet = 1M
table_cache = 256
sort_buffer_size = 1M
read_buffer_size = 1M
read_rnd_buffer_size = 4M
myisam_sort_buffer_size = 64M
thread_cache_size = 8
query_cache_size = 16M
thread_concurrency = 8
log-slow-queries = /var/log/mysql/mysql-slow.</description></item><item><title>[網站] 好站連結 (二)</title><link>https://blog.wu-boy.com/2009/05/%E7%B6%B2%E7%AB%99-%E5%A5%BD%E7%AB%99%E9%80%A3%E7%B5%90-%E4%BA%8C/</link><pubDate>Thu, 28 May 2009 05:29:35 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2009/05/%E7%B6%B2%E7%AB%99-%E5%A5%BD%E7%AB%99%E9%80%A3%E7%B5%90-%E4%BA%8C/</guid><description/></item><item><title>MySQL count(“欄位”) vs mysql_num_rows 速度？</title><link>https://blog.wu-boy.com/2009/03/mysql-count%E6%AC%84%E4%BD%8D-vs-mysql_num_rows-%E9%80%9F%E5%BA%A6%EF%BC%9F/</link><pubDate>Mon, 30 Mar 2009 11:28:35 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2009/03/mysql-count%E6%AC%84%E4%BD%8D-vs-mysql_num_rows-%E9%80%9F%E5%BA%A6%EF%BC%9F/</guid><description>&lt;p>在 FreeBSD ports 裡面還沒看到 chinese/phpbb3 的 ports，目前只有 &lt;a href="http://chinsan2.twbbs.org/wp/">chinsan&lt;/a> 維護的 &lt;a href="http://www.freshports.org/chinese/phpbb-tw/">chinese/phpbb-tw ports&lt;/a>，之前版本是 2.0.22 版本，後來我 commit 到 2.0.23 版本，不過 PHPBB 官網已經不再維護或者是開發 2.0.X 版本了，現在以 PHPBB3 為版本開發，也針對了 PHP6 跟 PHP 5 的相容性做了很大的改變，所以基本上如果在 2.0.X 版本加了很多外掛，那就沒辦法升級到 phpBB3 版本了，畢竟 code 實在改變太多了，找個時間把 chinese/phpbb3-tw commit 進去，不然也可以到 &lt;a href="http://www.freshports.org/www/phpbb3/">www/phpbb3&lt;/a> 做安裝。 為什麼會提到 &lt;a href="http://www.phpbb.com/">phpBB&lt;/a> 呢，今天在 trace &lt;a href="http://www.phpbb.com/">phpBB3&lt;/a> 的 code，發現原本在 phpBB2 裡面有支援 &lt;a href="http://tw2.php.net/mysql-num-rows">mysql_num_rows&lt;/a> function，用來讓程式可以取出 sql 的個數，不過在 &lt;a href="http://www.phpbb.com/">phpBB3&lt;/a> 竟然就把這個 function 拿掉了。 phpBB2 mysql4.php 程式：&lt;/p>
&lt;pre class="brush: php; title: ; notranslate" title="">function sql_numrows($query_id = 0)
{
if( !$query_id )
{
$query_id = $this->query_result;
}
return ( $query_id ) ? mysql_num_rows($query_id) : false;
}&lt;/pre></description></item><item><title>mydumper 取代 mysqldump 效能</title><link>https://blog.wu-boy.com/2009/03/mydumper-%E5%8F%96%E4%BB%A3-mysqldump-%E6%95%88%E8%83%BD/</link><pubDate>Mon, 09 Mar 2009 02:36:08 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2009/03/mydumper-%E5%8F%96%E4%BB%A3-mysqldump-%E6%95%88%E8%83%BD/</guid><description>&lt;p>這是我在 &lt;a href="http://blog.gslin.org">gslin 大神&lt;/a> 那邊看到的一篇文章：&lt;a href="http://blog.gslin.org/archives/2009/03/04/1956/">mydumper (取代 mysqldump 的工具)&lt;/a>，&lt;a href="http://dammit.lt/2009/02/03/mydumper/">mysqldumper&lt;/a> 有平行跟效能方面壓力測試，效果跟時間都壓縮的比 &lt;a href="http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html">mysqldump&lt;/a> 還要快，簡單管理 output 資料，它把 database 每個資料表分別 dump 資料出來寫到檔案，方便觀看檔案資料，不過沒有支援 dump table 的 definitions，所以加速提取 data 寫入到檔案，gslin 大神也把它包進 &lt;a href="http://www.freebsd.org">FreeBSD&lt;/a> &lt;a href="http://www.freebsd.org/ports/">ports&lt;/a> 裡面，在 &lt;a href="http://www.freshports.org/databases/mydumper/">database/mydumper&lt;/a> 這裡。 我想會把這個機制套用到我之前寫的 shell script 裡面：&lt;a href="http://blog.wu-boy.com/2008/05/23/268/">[Linux&amp;amp;FreeBSD] 備份系統資料，MySQL 資料庫，PgSQL 資料庫的自動化 bash shell script 程式&lt;/a>，那 mydumper 用法也相當簡單，mydumper &amp;ndash;help 就寫的很清楚了，跟 mysqldump 用法差沒多少：&lt;/p>
&lt;pre class="brush: bash; title: ; notranslate" title="">-h, --host 連接到 hostname 伺服器
-u, --user 使用者名稱
-p, --password 使用者密碼
-P, --port MySQL TCP/IP port
-B, --database Database 名稱
-t, --threads Number of parallel threads
-o, --outputdir 輸出的檔案要存放在哪, 預設 ./export-*/
-c, --compress gzip 壓縮每個檔案，多花一點時間
-x, --regex Regular expression for 'db.table' matching&lt;/pre></description></item><item><title>[MySQL]left, right, inner, outer join 使用方法</title><link>https://blog.wu-boy.com/2009/01/mysqlleft-right-inner-outer-join-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</link><pubDate>Sat, 24 Jan 2009 12:09:39 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2009/01/mysqlleft-right-inner-outer-join-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</guid><description>&lt;p>最近在高雄面試的時候，被問到的資料庫問題，什麼是 left join，out join，inner join，其實這些都是寫基本 SQL 語法需要知道的，當然我比較少用到 out join，不過還是要知道一下比較好喔，底下來說明一下這些，整理一些心得&lt;/p>
&lt;h2 id="表格-test1-資料表">表格 test1 資料表&lt;/h2>
&lt;p>&lt;a href="https://www.flickr.com/photos/appleboy/3222461660/" title="2 (by appleboy46)">&lt;img src="https://i2.wp.com/farm4.static.flickr.com/3327/3222461660_4203972953_o.jpg?resize=171%2C92&amp;#038;ssl=1" title="2 (by appleboy46)" alt="2 (by appleboy46)" data-recalc-dims="1" />&lt;/a>&lt;/p>
&lt;h2 id="表格-test2-資料表">表格 test2 資料表&lt;/h2>
&lt;p>&lt;a href="https://www.flickr.com/photos/appleboy/3222461636/" title="1 (by appleboy46)">&lt;img src="https://i1.wp.com/farm4.static.flickr.com/3328/3222461636_c25a9bf9e5_o.jpg?resize=126%2C121&amp;#038;ssl=1" title="1 (by appleboy46)" alt="1 (by appleboy46)" data-recalc-dims="1" />&lt;/a>&lt;/p></description></item><item><title>[MySQL] 實做 MySQL Master-Master Replication 同步</title><link>https://blog.wu-boy.com/2008/12/mysql-%E5%AF%A6%E5%81%9A-mysql-master-master-replication-%E5%90%8C%E6%AD%A5/</link><pubDate>Tue, 30 Dec 2008 14:10:59 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2008/12/mysql-%E5%AF%A6%E5%81%9A-mysql-master-master-replication-%E5%90%8C%E6%AD%A5/</guid><description>&lt;p>今天無聊實做了 &lt;a href="http://www.mysql.com/">MySQL&lt;/a> 資料庫同步化，那可以先看看 &lt;a href="http://dev.mysql.com/doc/refman/5.0/en/replication.html">MySQL Master Slave Replication&lt;/a>，中文網站可以上 google 查詢或者是看看這一篇：&lt;a href="http://plog.longwin.com.tw/my_note-app-setting/2008/03/11/mysql_replication_master_slave_set_2008">MySQL 設定 Replication (Master – Slave)&lt;/a>，基本上設定還蠻容易的，如果會 Master 同步到 Slave 的話，那 MySQL Master-Master 只是在用相同的方法在做一遍，如果不懂 MMM 的可以先參考這一篇：&lt;a href="http://plog.longwin.com.tw/news-technology/2008/10/21/mysql-master-replication-manager-mmm-intro-2008">MySQL Master-Master Replication Manager(1) – 簡介&lt;/a>，這篇寫的很清楚，今天看了文章，我實做起來，遇到一些問題，其實還蠻奇怪的，所以底下就來紀錄一下步驟，順便也說明一下。 實做兩台 Ubuntu 機器： db1：192.168.1.1 db2：192.168.1.2 先設定 db1： 目前我都是在 Ubuntu 7.10 底下實做的，那基本上只要有支援 MySQL 的 Linux 或者 FreeBSD 機器都可以實做這個方法： &lt;strong>&lt;span style="color: #ff0000;">步驟一：先修改 my.cnf 這個檔案：&lt;/span>&lt;/strong> FreeBSD 的話在：/var/db/mysql/my.cnf Ubuntu：/etc/mysql/my.cnf 有的版本是在 /etc/my.cnf 所以不太一定，請依照自己的作業系統 修改：&lt;/p>
&lt;pre class="brush: bash; title: ; notranslate" title="">#
# bind-address 請 mark 起來，因為我們必須讓 MySQL Listen 各個不同的 IP Address
#bind-address = 127.0.0.1
#
# server id 請記得每台機器都設定不同喔
#
server-id = 1
log_bin = /var/log/mysql/mysql-bin.log&lt;/pre></description></item><item><title>[Ubuntu &amp; java] java JDBC and MySQL</title><link>https://blog.wu-boy.com/2008/11/ubuntu-java-java-jdbc-and-mysql/</link><pubDate>Sat, 15 Nov 2008 12:34:10 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2008/11/ubuntu-java-java-jdbc-and-mysql/</guid><description>&lt;p>最近開始要摸 &lt;a href="http://zh.wikipedia.org/wiki/Java">java&lt;/a> 了，目前大概先實做 java with &lt;a href="http://java.sun.com/javase/technologies/database/">JDBC&lt;/a> 連接 MySQL，所以在 &lt;a href="http://www.javaworld.com.tw">JavaWorld@TW&lt;/a> 這裡找了一些相關的文件，目前我在 Linux 底下實做，還沒找到一套很適合的 IDE Tool 來撰寫程式碼，大家好像都很推 &lt;a href="http://www.netbeans.org/">netbeans&lt;/a> 跟 &lt;a href="http://www.eclipse.org/">eclipse&lt;/a>，不過我目前還是使用 &lt;a href="http://www.pspad.com/">PSPad&lt;/a> 來撰寫 java 程式碼，然後透過 FTP 的方式編輯，這不是重點，重點是要透過 jdbc 來連接 MySQL，目前是在 &lt;a href="http://www.ubuntu-tw.org/">Ubuntu&lt;/a> 7.04 這一版本上面實做，底下是實做方法： 1. 首先先安裝 deb 檔案：透過 apt-get 的方式&lt;/p>
&lt;pre class="brush: bash; title: ; notranslate" title="">#
# 首先尋找 java lib with mysql
apt-get install libmysql-java
&lt;/pre> 2. 安裝好之後尋找 jar 檔案，加入到 class path 裡面
&lt;pre class="brush: bash; title: ; notranslate" title="">#
# 首先 echo $CLASSPAT
#
# java mysql jar 檔案如下
/usr/share/java/mysql.jar
# 加入 CLASSPATH，修改 /etc/bash.bashrc
export CLASSPATH=$CLASSPATH:/usr/share/java/mysql.jar
# 然後在
source /etc/bash.bashrc&lt;/pre></description></item><item><title>[轉載]MySQL 的 “SET NAMES xxx” 字元編碼問題分析</title><link>https://blog.wu-boy.com/2008/08/%E8%BD%89%E8%BC%89mysql-%E7%9A%84-set-names-xxx-%E5%AD%97%E5%85%83%E7%B7%A8%E7%A2%BC%E5%95%8F%E9%A1%8C%E5%88%86%E6%9E%90/</link><pubDate>Mon, 25 Aug 2008 10:02:35 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2008/08/%E8%BD%89%E8%BC%89mysql-%E7%9A%84-set-names-xxx-%E5%AD%97%E5%85%83%E7%B7%A8%E7%A2%BC%E5%95%8F%E9%A1%8C%E5%88%86%E6%9E%90/</guid><description>&lt;p>轉載自: &lt;a href="http://www.phpchina.com/bbs/viewthread.php?tid=13861">PHPChina&lt;/a> 近來接受 BBT 的培訓，做一個投票系統。系統程式碼倒不是很難，但是我的時間主要花費在了研究字符集和編碼上面。MySQL 和 Apache 兩個系統的編碼（字符集）問題讓我費勁腦筋，吃盡苦頭。網上對這些問題的解決比較零散，比較片面，大部分是提供解決方法，卻不說為什麼。於是我將這幾天收穫總結一下，避免後來者再走彎路。這篇文章對 PHP 編寫有一點幫助（看完你就知道，怎樣讓你的 PHP 程式在大部分空間提供商的伺服器裡顯示正常），但是更多幫助在於網路伺服器的架設和設置。 先說 MySQL 的字符集問題。Windows 下可透過修改 my.ini 內的&lt;/p>
&lt;pre class="brush: bash; title: ; notranslate" title=""># CLIENT SECTION
[mysql]
default-character-set=utf8
# SERVER SECTION
[mysqld]
default-character-set=utf8&lt;/pre></description></item><item><title>[轉貼] RoR：Ruby on Rails的部署方案選擇</title><link>https://blog.wu-boy.com/2008/07/%E8%BD%89%E8%B2%BC-ror%EF%BC%9Aruby-on-rails%E7%9A%84%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E9%81%B8%E6%93%87/</link><pubDate>Thu, 10 Jul 2008 02:04:01 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2008/07/%E8%BD%89%E8%B2%BC-ror%EF%BC%9Aruby-on-rails%E7%9A%84%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E9%81%B8%E6%93%87/</guid><description>我沒在玩 Ruby on Rails，但是底下這一篇我覺得寫的不錯，可以參考看看，裡面有介紹一下目前當紅 web daemon 的一些基本知識
RoR的部署方式從架構上來說分為前端和後端： 一、前端 前端的作用就是處理靜態資源，將動態請求分發到後端，有時候也帶有一些額外的功能，例如對特定URL進行rewrite和redirect，對HTTP輸出進行gzip壓縮等等。 前端目前已知的可以選擇apache, lighttpd, litespeed, nginx, haproxy 1、apache2.2 apache是全球市場佔有率最高的web server，超過全球互聯網網站50%的網站都用apache。apache2.2 + mod_proxy_balancer是一個非常流行，非常穩定的方案。 使用apache2.2唯一的問題就是apache的性能和後面那些輕量級web server相比，差太遠了。一方面在處理靜態請求方面apache要比lighttpd慢3-5倍，內存消耗和CPU消耗也高出一個數量級，另一方面 mod_proxy_balancer的分發性能也不高，比haproxy差很遠。 2、lighttpd lighttpd 是一個輕量級高性能web server，一個在MySQL Inc工作的德國人寫的。性能很好，內存和CPU資源消耗很低，支持絕大多數apache的功能，是apache的絕好替代者。目前lighttpd已經上升到全球互聯網第四大web server，市場佔有率僅此於apache，IIS和Sun。 lighttpd唯一的問題是proxy功能不完善，因此不適合搭配mongrel來使用。lighttpd下一個版本1.5.0的proxy模塊重寫過了，將會解決這個問題。 3、litespeed 和 lighttpd差不多，商業產品，收費的。比lighttpd來說，多一個web管理界面，不用寫配置文件了。litespeed專門為單機運行的 RoR開發了一個lsapi協議，號稱性能最好，比httpd和fcgi都要好。他的proxy功能比lighttpd完善。 litespeed 的缺點我卻認為恰恰是這個lsapi。因為lsapi不是web server啟動的時候啟動固定數目的ruby進程，而是根據請求繁忙程度，動態創建和銷毀ruby進程，貌似節省資源，實則和apache2.2進程模型一樣，留下很大的黑客攻擊漏洞。只要黑客瞬時發起大量動態請求，就會讓服務器忙於創建ruby進程而導致CPU資源耗盡，失去響應。 當然，litespeed也支持httpd和fcgi，這個和lighttpd用法一樣的，到沒有這種問題。 4、nginx 一個俄國人開發的輕量級高性能web server，特點是做proxy性能很好，因此被推薦取代apache2.2的mod_proxy_balancer，來和mongrel cluster搭配。其他方面和lighttpd到差不多。 要說缺點，可能就是發展的時間比較短，至今沒有正式版本，還是beta版。沒有經過足夠網站的驗證。 5、haproxy 就是一個純粹的高性能proxy，不處理靜態資源的，所有請求統統分發到後端。 二、後端 後端就是跑ruby進程，處理RoR動態請求了。運行後端ruby進程有兩種方式： 1、fcgi方式 準確的說，不能叫做fcgi方式，其實就是啟動一個ruby進程，讓這個ruby進程監聽一個tcp/unix socket，以fcgi協議和前端通訊。所以fcgi不是指ruby進程的運行方式，而是ruby進程使用的通訊協議。這就好比你tomcat可以用 http也可以使用ajp通訊一樣，tomcat自己的運行方式都一樣的，只是通訊方式不一樣。 fcgi方式啟動ruby進程，可以使用lighttpd帶的一個spawn-fcgi工具來啟動(JavaEye目前採用這種方式)。 值得一提的是，apache2.2的mod_fastcgi的方式和上面還不太一樣，由apache動態創建fcgi進程和管理fcgi進程，這種方式和 litespeed的lsapi面臨的問題是一樣的，此外apache的mod_fastcgi自己也有很多嚴重的bug，是一種很糟糕的部署方式。這種糟糕的部署方式也敗壞了fcgi的名聲。 fastcgi只是一種協議，雖然古老，但並不是不好用，http協議也很古老。沒有必要因為 apache的mod_fastcgi的運行方式的問題而連帶把fastcgi都一同否定了。fastcgi只是一個協議(程序之間的語言)，是 apache的mod_fastcgi這個模塊有問題。打個比方，有個人英語水平很差，和你用英語對話，總是結結巴巴的，那你說是英語(fastcgi) 這種語言有問題呢？還是和你對話的這個人 (mod_fastcgi)有問題呢？ 2、http方式 也就是用mongrel去跑ruby進程，由於mongrel實際上已經是一個簡單的http server，所以也可以單獨作為web server使用。mongrel現在越來越受歡迎了。 用fcgi方式還是http方式，我個人覺得區別不大，關鍵還是看應用的場合，一般而言，推薦的搭配是： lighttpd ＋ fcgi 或者 nginx ＋mongrel，而apache因為性能差距，而不被推薦。 JavaEye為什麼用lighttpd ＋ fcgi呢？原因如下： 1) lighttpd發展了好幾年了，市場佔有率也相當高，是一個經過實踐檢驗的server，它的文檔也很全；而nginx還沒有經過足夠的市場檢驗，文檔也很缺乏 2) JavaEye的ruby進程和web server在一台機器上面跑，通過unix socket使用fcgi協議通訊可以避免tcp的網絡開銷，其通訊速度比使用tcp socket使用http協議通訊要快一些。 什麼場合使用haproxy？ 大規模部署，例如你的RoR應用到十幾台服務器上面去，你用haproxy會更好，可以方便的添加刪除應用服務器節點，proxy性能更好。 資料來源： Csdn – http://news.</description></item><item><title>[PHP]解決網站被 SQL injection 攻擊</title><link>https://blog.wu-boy.com/2008/06/php%E8%A7%A3%E6%B1%BA%E7%B6%B2%E7%AB%99%E8%A2%AB-sql-injection-%E6%94%BB%E6%93%8A/</link><pubDate>Thu, 26 Jun 2008 08:26:51 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2008/06/php%E8%A7%A3%E6%B1%BA%E7%B6%B2%E7%AB%99%E8%A2%AB-sql-injection-%E6%94%BB%E6%93%8A/</guid><description>&lt;p>其實這個安全性的問題，在目前台灣網站都存在這樣的問題，大家平常用 $_POST，$_GET 用得很順利，但是沒有想過帳號密碼被 SQL injection 破解，當網站被破解了，基本上你損失就是相當嚴重，網路上也有很多攻擊方式，不過這方法是最常被拿出來講的，我自己有一套解決方式，除了比較重要的地方，就是輸入帳號密碼的地方要加強防護之外，加上數字驗證碼，還要 check 帳號的特性，我底下是我驗證帳號密碼機制&lt;/p>
&lt;pre class="brush: php; title: ; notranslate" title="">if($user_name == '' || $user_passwd == ''){
ErrMsg("帳號或密碼不得空白");
}
if (!preg_match('/^\w+$/', $user_name)){
ErrMsg("請勿攻擊本站台");
}&lt;/pre></description></item><item><title>基本優化 tuning apache 跟 tuning mysql 跟 php 效能</title><link>https://blog.wu-boy.com/2008/06/%E5%9F%BA%E6%9C%AC%E5%84%AA%E5%8C%96-tuning-apache-%E8%B7%9F-tuning-mysql-%E6%95%88%E8%83%BD/</link><pubDate>Wed, 18 Jun 2008 13:42:57 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2008/06/%E5%9F%BA%E6%9C%AC%E5%84%AA%E5%8C%96-tuning-apache-%E8%B7%9F-tuning-mysql-%E6%95%88%E8%83%BD/</guid><description>&lt;p>最近在玩優化 Apache 跟 MySQL 部份，然後就在 google 上面找一些資料，當然對我自己的網站當然改變不少，速度有增快許多，所以來紀錄一下，其實都是還蠻基本的改 config 檔案就可以了 1. apache 部份 for FreeBSD&lt;/p>
&lt;pre class="brush: bash; title: ; notranslate" title="">#
# 利用 ports 安裝
# 在安裝 Apache 時，加入此參數 WITH_MPM=XXXX 即可。
#
cd /usr/ports/www/apache22 ; make WITH_MPM=worker install clean&lt;/pre> 如果是要裝在 Linux 機器的話，可能要自己編譯，在 Apache 2.0 有很多效能上得改變，所以原本預設是 prefork
&lt;pre class="brush: bash; title: ; notranslate" title="">#
# 編譯加上
#
./configure --with-mpm=worker&lt;/pre> 在 Ubuntu 底下作法很奇怪，利用 apt-get 方式不能安裝 mpm worker，因為你安裝 php 的時候他會幫你移除，然後裝上 prefork，所以很奇怪，這部份我還不知道怎麼解決。</description></item><item><title>[DataBase] 備份 MySQL 3.23.49 轉到 MySQL 5 utf8 轉換到 utf8</title><link>https://blog.wu-boy.com/2008/05/database-%E5%82%99%E4%BB%BD-mysql-32349-%E8%BD%89%E5%88%B0-mysql-5-utf8-%E8%BD%89%E6%8F%9B%E5%88%B0-utf8/</link><pubDate>Fri, 09 May 2008 01:00:53 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2008/05/database-%E5%82%99%E4%BB%BD-mysql-32349-%E8%BD%89%E5%88%B0-mysql-5-utf8-%E8%BD%89%E6%8F%9B%E5%88%B0-utf8/</guid><description>&lt;p>最近在幫友人處理他們web跟資料庫的轉移，然後發現他們的資料庫是很古早的資料庫 MySQL 3.23.49 版本，相當古老吧，因為那個時候我才正值大二時代，剛開始接觸電腦的時候而已，連最基本的資料庫都不知道是什麼，哈哈經過這麼久終於發展到 MySQL 5版本了，不過從 MySQL 4.x 開始支援的 Unicode 系統，所以當時也有很多人遇到轉換問題，我今天也遇到相同問題，不過是在轉換到 Linux Centos 5.1 版本底下，原本機器使用 Red Hat Linux 7.3，真是一個很舊的版本，因為 Red Hat Linux 已經到 9.0 版本了，而且目前不維護了。 之前版本轉換都沒有什麼問題，就是 4.x 轉到 5.x 版本，參可我之前寫的這篇 &lt;a href="http://blog.wu-boy.com/2007/04/08/92/">[Mysql] 資料庫備份[big5]utf8轉換成utf-8&lt;/a>，如果這篇文章解決不了的話，那就可能用我底下的方法了，不過過上面那個方法不適合用在 3.23 轉到 5.x 版，因為還是會發生亂碼現象，可是這只會發生在 Linux 底下，因為我用 FreeBSD 7.0 R 版，在這環境底下是沒有問題的，所以今天很囧，都在處理 Linux 的部份，哈哈，所以大家還是去用 FreeBSD 吧&lt;/p></description></item><item><title>[FreeBSD &amp; Linux Ubuntu] Proftpd 支援 UTF-8 + MYSQL 虛擬帳號 + Quota 限制</title><link>https://blog.wu-boy.com/2008/04/freebsd-linux-ubuntu-proftpd-%E6%94%AF%E6%8F%B4-utf-8-mysql-%E8%99%9B%E6%93%AC%E5%B8%B3%E8%99%9F-quota-%E9%99%90%E5%88%B6/</link><pubDate>Fri, 25 Apr 2008 15:26:56 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2008/04/freebsd-linux-ubuntu-proftpd-%E6%94%AF%E6%8F%B4-utf-8-mysql-%E8%99%9B%E6%93%AC%E5%B8%B3%E8%99%9F-quota-%E9%99%90%E5%88%B6/</guid><description>&lt;p>今天突然想到要玩一下 &lt;a href="http://www.proftpd.org/">Proftpd&lt;/a> 的 MYSQL 虛擬帳號認證部份，我是用 FreeBSD 7.0 Release 下去安裝的，剛剛去看了一下官方網站，從 1.3.1rc1 版開始，支援 UTF-8 傳送跟接收了，請看 &lt;a href="http://www.proftpd.org/docs/RELEASE_NOTES-1.3.1rc1">RELEASE_NOTES-1.3.1rc1&lt;/a>，所以1.2.10版本之前的都不支援 UTF-8 不過台灣有人 patch 出來可以支援 Big5，現在都不用了，裡面有一段簡介&lt;/p>
&lt;blockquote>
&lt;p>UseUTF8 Disables use of UTF8 encoding for file paths. If the –enable-nls configure option is used, then UTF8 encoding support will be enabled by default. 如果你的 server 是用此版本，或者是更高，請在編譯的時候加入 –enable-nls&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>–enable-nls This configure option enables handling of translated message catalogs for response messages, and also enables handling of UTF8 paths in client commands.&lt;/p>
&lt;/blockquote></description></item><item><title>[Mysql] 資料庫備份[big5]utf8轉換成utf-8</title><link>https://blog.wu-boy.com/2007/04/mysql-%E8%B3%87%E6%96%99%E5%BA%AB%E5%82%99%E4%BB%BDbig5utf8%E8%BD%89%E6%8F%9B%E6%88%90utf-8/</link><pubDate>Sun, 08 Apr 2007 13:14:29 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2007/04/mysql-%E8%B3%87%E6%96%99%E5%BA%AB%E5%82%99%E4%BB%BDbig5utf8%E8%BD%89%E6%8F%9B%E6%88%90utf-8/</guid><description>&lt;p>其實在很多opensource底下的套裝軟體，資料庫預設都是用 utf8，我想這會造成在 phpMyAdmin 底下看到亂碼，然後自己之前也有遇到問題，然後又在網路上看到這篇 &lt;a title="Permanent Link: 搶救 xdite.net 所用的奇技淫巧" rel="bookmark" href="http://blog.xdite.net/?p=307">搶救 xdite.net 所用的奇技淫巧&lt;/a> 裡面所寫的備份方式跟我在轉換 phpBB2 跟自己的 wordpress 一樣 大同小異，我還在想說有更好的解法說，看來是沒有，在 wordpress 底下，只能利用後台的資料庫備份，不然用phpMyAdmin的話，我想你備份出來也是沒用。&lt;/p></description></item><item><title>[Linux] Ubuntu 6.06 Proftpd + Mysql 安裝方式</title><link>https://blog.wu-boy.com/2006/10/linux-ubuntu-606-proftpd-mysql-%E5%AE%89%E8%A3%9D%E6%96%B9%E5%BC%8F/</link><pubDate>Sat, 21 Oct 2006 16:17:51 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2006/10/linux-ubuntu-606-proftpd-mysql-%E5%AE%89%E8%A3%9D%E6%96%B9%E5%BC%8F/</guid><description>ProFTPD Version 1.2.10 Mysql Version 4.1.0 支援 UTF8 請確定你的proftpd有支援sql module
proftpd -l | grep mysql
proftpd -l | grep sql
mod_sql.c
mod_sql_mysql.c
mod_quotatab_sql.c 確定有支援之後 再來就是建立mysql資料庫 * 建立 proftp 資料庫 CREATE DATABASE `ftp` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci; * 建立使用者資料表 CREATE TABLE `ftp` (
`username` varchar( 60 ) default NULL ,
`uid` int( 11 ) NOT NULL ,
`gid` int( 11 ) default NULL ,
`password` varchar( 30 ) default NULL ,
`homedir` varchar( 60 ) default NULL ,
`shell` varchar( 11 ) default ‘/bin/false’,
PRIMARY KEY ( `uid` ) ,
UNIQUE KEY ( `username` )
) TYPE = MYISAM; 此資料表是在紀錄使用者的基本資訊，uid是使用者系統uid，gid是使用者group的id，passwd使用者的密碼 homedir為使用者登入的家目錄， shell可以為該使用者指定相應的shell * 建立使用者群組資料表 CREATE TABLE `groups` (
`groupname` varchar( 30 ) NOT NULL default ‘’,
`gid` int( 11 ) NOT NULL default ‘0′,
`members` text default NULL
) TYPE = MYISAM; 其中grpname是組的名稱，gid是系統組的ID，members是組的成員。注意：多成員，他們之間要用逗號隔開，不能使用空格 例如 3個使用者 test1 test2 test3 ，members就要寫 (test1,test2,test3) #設置MySQL認證： SQLConnectInfo 資料庫 資料庫帳號 資料庫密碼 #設置user資料表資訊『對應你的設定的資料表』 SQLUserInfo ftp username password uid gid homedir shell #設置group資料表資訊『對應你的設定的資料表』 SQLGroupInfo groups groupname gid members #設定使用者密碼編碼方式 ex：Plaintext 純文字 SQLAuthTypes Plaintext #設定mysql log檔 SQLLogFile /var/log/sql.</description></item><item><title>FreeBSD + Lighttpd + php + mysql 安裝過程</title><link>https://blog.wu-boy.com/2006/09/freebsd-lighttpd-php-mysql-%E5%AE%89%E8%A3%9D%E9%81%8E%E7%A8%8B/</link><pubDate>Wed, 20 Sep 2006 01:57:13 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2006/09/freebsd-lighttpd-php-mysql-%E5%AE%89%E8%A3%9D%E9%81%8E%E7%A8%8B/</guid><description>系統環境 ：FreeBSD 6.0-RELEASE 安裝過程如下：
mysql-server-5.0.24a php5-5.1.6 lighttpd-1.4.11_1 先安裝 lighttpd
cd /usr/ports/www/lighttpd/ make config [X] OPENSSL Enable SSL support [ ] OPENLDAP Enable LDAP support [X] MYSQL Enable MYSQL support [X] IPV6 Enable IPV6 support [X] CML Enable Cache Meta Language support make install clean 安裝 mysql cd /usr/ports/databases/mysql50-server make install clean WITH_CHARSET=utf8 WITH_LINUXTHREADS=yes 安裝 php cd /usr/ports/lang/php5 cd /usr/ports/lang/php5-extensions/ make config 選擇你想要的 extensions 灌好之後 就可以用了 然後打開 家目錄設定 userdir.path = “public_html” userdir.</description></item></channel></rss>
<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>用 AWS EFS 或 FSx Lustre 加速 Sagemaker AI 模型訓練 - 小惡魔 - AppleBOY</title><meta name=description content="
前不久寫過一篇『AI 團隊整合導入 AWS SageMaker 流程』介紹如何用 Go 語言整合 SageMaker API。本篇會介紹在訓練 AI 模型前，如何將 Dataset 準備好並整合 SageMaker，過程中遇到什麼問題跟挑戰。團隊提供 AI 平台讓使用者可以上傳自家的 Dataset 搭配團隊內部預設的 Dataset 進行 AI 模型的訓練，最後將模型提供給使用者下載使用，簡單來說，使用者只需要提供 Dataset 並把 AI 訓練參數設定完畢，就可以拿到最後的模型進行後續的整合開發。底下我們探討使用者上傳 Dataset 的流程。"><meta name=author content="Appleboy"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"小惡魔 - AppleBOY","url":"https:\/\/blog.wu-boy.com"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/blog.wu-boy.com"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/blog.wu-boy.com","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/blog.wu-boy.com\/2021\/09\/speed-up-amazon-sagemaker-training-using-efs-or-fsx-lustre\/","name":"用 aws efs 或 fsx lustre 加速 sagemaker ai 模型訓練"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"appleboy"},"headline":"用 AWS EFS 或 FSx Lustre 加速 Sagemaker AI 模型訓練","description":"\n前不久寫過一篇『AI 團隊整合導入 AWS SageMaker 流程』介紹如何用 Go 語言整合 SageMaker API。本篇會介紹在訓練 AI 模型前，如何將 Dataset 準備好並整合 SageMaker，過程中遇到什麼問題跟挑戰。團隊提供 AI 平台讓使用者可以上傳自家的 Dataset 搭配團隊內部預設的 Dataset 進行 AI 模型的訓練，最後將模型提供給使用者下載使用，簡單來說，使用者只需要提供 Dataset 並把 AI 訓練參數設定完畢，就可以拿到最後的模型進行後續的整合開發。底下我們探討使用者上傳 Dataset 的流程。\n","inLanguage":"en","wordCount":619,"datePublished":"2021-09-04T12:43:19","dateModified":"2021-09-04T12:43:19","image":"https:\/\/lh3.googleusercontent.com\/Kq9CxHZWopKj__EgF_BpzLv8FhwvDkc0iacrl9V5IJjpr-dZ7Y5O-Vc1i9FhGQ8gHTdKeBisG_1ie1IONQXmK0a3myyl_BNouP76CLHGHRzsPPRgRF3RiKYqOkdS86mZOIu7KYFTUio=w1920-h1080","keywords":["sagemaker, golang, FSx, Lustre, EFS, terraform"],"mainEntityOfPage":"https:\/\/blog.wu-boy.com\/2021\/09\/speed-up-amazon-sagemaker-training-using-efs-or-fsx-lustre\/","publisher":{"@type":"Organization","name":"https:\/\/blog.wu-boy.com","logo":{"@type":"ImageObject","url":"https:\/\/lh3.googleusercontent.com\/Kq9CxHZWopKj__EgF_BpzLv8FhwvDkc0iacrl9V5IJjpr-dZ7Y5O-Vc1i9FhGQ8gHTdKeBisG_1ie1IONQXmK0a3myyl_BNouP76CLHGHRzsPPRgRF3RiKYqOkdS86mZOIu7KYFTUio=w1920-h1080","height":60,"width":60}}}</script><meta property="og:title" content="用 AWS EFS 或 FSx Lustre 加速 Sagemaker AI 模型訓練"><meta property="og:description" content="
前不久寫過一篇『AI 團隊整合導入 AWS SageMaker 流程』介紹如何用 Go 語言整合 SageMaker API。本篇會介紹在訓練 AI 模型前，如何將 Dataset 準備好並整合 SageMaker，過程中遇到什麼問題跟挑戰。團隊提供 AI 平台讓使用者可以上傳自家的 Dataset 搭配團隊內部預設的 Dataset 進行 AI 模型的訓練，最後將模型提供給使用者下載使用，簡單來說，使用者只需要提供 Dataset 並把 AI 訓練參數設定完畢，就可以拿到最後的模型進行後續的整合開發。底下我們探討使用者上傳 Dataset 的流程。"><meta property="og:image" content="https://i.imgur.com/X4wpl6d.png"><meta property="og:url" content="https://blog.wu-boy.com/2021/09/speed-up-amazon-sagemaker-training-using-efs-or-fsx-lustre/"><meta property="og:type" content="website"><meta property="og:site_name" content="小惡魔 - AppleBOY"><meta name=twitter:title content="用 AWS EFS 或 FSx Lustre 加速 Sagemaker AI 模型訓練"><meta name=twitter:description content="
前不久寫過一篇『AI 團隊整合導入 AWS SageMaker 流程』介紹如何用 Go 語言整合 SageMaker API。本篇會介紹在訓練 AI 模型前，如何將 Dataset 準備好並整合 SageMaker，過程中遇到什麼問題跟挑戰。團隊提供 AI 平台讓使用者可以上傳自家的 Dataset 搭配團隊內部預設的 Dataset 進行 AI 模型的訓練，最後將模型提供給使用者下載使用，簡單 …"><meta name=twitter:image content="https://i.imgur.com/X4wpl6d.png"><meta name=twitter:card content="summary"><meta name=twitter:site content="@appleboy"><meta name=twitter:creator content="@appleboy"><link href=https://i.imgur.com/PpOg8Dz.jpg rel=icon type=image/x-icon><meta name=generator content="Hugo 0.109.0"><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css><link rel=stylesheet href=https://blog.wu-boy.com/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://blog.wu-boy.com/css/syntax.css><link rel=stylesheet href=https://blog.wu-boy.com/css/codeblock.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-5766319-6","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=https://blog.wu-boy.com>小惡魔 - AppleBOY</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title="Youtube 頻道" href=http://bit.ly/youtube-boy><i class="fab fa-youtube"></i> Youtube 頻道</a></li><li class=navlinks-container><a class=navlinks-parent><i class="fas fa-video"></i> 線上課程</a><div class=navlinks-children><a href=/golang-online-course/>Go 語言基礎實戰</a>
<a href=/docker-course/>Docker 容器開發實戰</a>
<a href=/drone-devops/>一天學會 DevOps 自動化流程</a></div></li><li><a title=歷年文章 href=/archives/><i class="fas fa-sitemap fa-lg"></i> 歷年文章</a></li><li><a href=#modalSearch data-toggle=modal data-target=#modalSearch style=outline:none><span class="hidden-sm hidden-md hidden-lg">Search</span> <span id=searchGlyph class="glyphicon glyphicon-search"></span></a></li></ul></div><div class=avatar-container><div class=avatar-img-border><a title="小惡魔 - AppleBOY" href=https://blog.wu-boy.com><img class=avatar-img src="https://lh3.googleusercontent.com/Kq9CxHZWopKj__EgF_BpzLv8FhwvDkc0iacrl9V5IJjpr-dZ7Y5O-Vc1i9FhGQ8gHTdKeBisG_1ie1IONQXmK0a3myyl_BNouP76CLHGHRzsPPRgRF3RiKYqOkdS86mZOIu7KYFTUio=w1920-h1080" alt="小惡魔 - AppleBOY"></a></div></div></div></nav><div id=modalSearch class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><button type=button class=close data-dismiss=modal>&#215;</button><h4 class=modal-title>Search 小惡魔 - AppleBOY</h4></div><div class=modal-body><gcse:search></gcse:search></div><div class=modal-footer><button type=button class="btn btn-default" data-dismiss=modal>Close</button></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-md-10 col-md-offset-1"><div class=post-heading><h1>用 AWS EFS 或 FSx Lustre 加速 Sagemaker AI 模型訓練</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on September 4, 2021
&nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;3&nbsp;minutes
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;619&nbsp;words
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;appleboy</span></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-md-10 col-md-offset-1"><aside class=toc-article><nav id=TableOfContents><ul><li><ul><li><a href=#上傳流程>上傳流程</a></li><li><a href=#檔案問題>檔案問題</a></li><li><a href=#使用-amazon-fsx-for-lustre>使用 Amazon FSx for Lustre</a></li><li><a href=#使用-amazon-elastic-file-system>使用 Amazon Elastic File System</a></li><li><a href=#使用心得>使用心得</a></li><li><a href=#參考連結>參考連結</a></li></ul></li></ul></nav></aside><article role=main class=blog-post><p><img src=https://i.imgur.com/X4wpl6d.png alt=cover></p><p>前不久寫過一篇『<a href=https://blog.wu-boy.com/2021/06/integratate-sagemaker-workflow-using-golang-api/>AI 團隊整合導入 AWS SageMaker 流程</a>』介紹如何用 <a href=https://golang.org>Go 語言</a>整合 <a href=https://aws.amazon.com/tw/pm/sagemaker/>SageMaker API</a>。本篇會介紹在訓練 AI 模型前，如何將 Dataset 準備好並整合 SageMaker，過程中遇到什麼問題跟挑戰。團隊提供 AI 平台讓使用者可以上傳自家的 Dataset 搭配團隊內部預設的 Dataset 進行 AI 模型的訓練，最後將模型提供給使用者下載使用，簡單來說，使用者只需要提供 Dataset 並把 AI 訓練參數設定完畢，就可以拿到最後的模型進行後續的整合開發。底下我們探討使用者上傳 Dataset 的流程。</p><h2 id=上傳流程>上傳流程</h2><p><img src=https://i.imgur.com/X4wpl6d.png alt=cover></p><p>使用者上傳的會是整包 <code>.zip</code> 格式的 Image 檔案，拿到檔案後，需要轉換成 tfrecord 格式，再重新打包上傳到 <a href=https://aws.amazon.com/tw/s3/>AWS S3</a> 空間。上團可以看到，後端開發一套 CLI 工具，使用者透過 CLI 進行認證，並將檔案上傳到 AWS S3 儲存空間，一旦上傳完畢後，S3 會發送 Push Event 到 <a href=https://aws.amazon.com/tw/sqs/>AWS SQS</a> 內，這時後端會在提供另一個服務來接受 SQS 訊息，每次拿到訊息後，會將檔案下載進行轉換，在打包上傳回 S3，並且將過程的訊息，傳回 API 服務，通知前端。</p><h2 id=檔案問題>檔案問題</h2><p>在講問題前，先來看看 SageMaker 訓練模型流程，底下先看看 Training Job 流程:</p><p><img src=https://i.imgur.com/K57zeNx.png alt="job flow"></p><p>可以看到第二個步驟是 <code>Downloading</code>，也就是每一次的 Training 過程，都需要從 S3 下載，這樣每次訓練，都需要浪費下載時間，而這個時間在 SageMaker 是算在訓練時間內，也就是需要花費的，假設檔案有個 100G，不只是讓訓練模型增加不少時間外，也額外多花了不少費用。</p><p>除了使用者提供的 Dataset 之外，還要加上自家的 <code>1TB</code> Dataset 進行訓練，那如果把 1TB 資料放在 S3 上面，從下載到解壓縮可能就要一小時跑不掉，所以透過 S3 這方案肯定是不行的，浪費時間跟金錢。故最終有跟台灣 AWS 團隊討論出使用 <a href=https://aws.amazon.com/tw/fsx/lustre/?>AWS FSx for Lustre</a> 解決方案。</p><h2 id=使用-amazon-fsx-for-lustre>使用 Amazon FSx for Lustre</h2><p>首先 Lustre 就是一個雲端網路磁碟，它的最大好處就是可以整合 AWS S3，只要 S3 上面有增加任何檔案，Lustre 就會隨時將檔案同步進來，但是這僅限於單向同步，也就是 <code>S3 -> Lustre</code>，如果將 Lustre 掛載到 EC2 上面，砍掉任何檔案，是不會同步到 S3 上面的，這點需要非常小心注意。</p><p>原本團隊的想法是，這樣挺不錯的，S3 可以同步到 Lustre 磁區內，但是這邊遇到問題是，本來 AWS S3 Bucket 上有綁定了 <code>ObjectCreated</code> 到 SQS 內部，如下面 <a href=https://github.com/hashicorp/hcl>HCL 語法</a>範例 (<a href=https://www.terraform.io/>Terraform</a>)，但是只要使用 S3 同步到 Lustre 內，也需要綁定同樣 Event，這邊就完全不能設定，會噴 API 錯誤，等於是要開發者二選一這功能，其實相當奇怪啊，理應上 AWS S3 要可以同步發送相同的 Event 到不同的 Target 才對，也因為這樣，團隊取消了將使用者的 Dataset 轉移到 Lustre 磁碟上。</p><div class=highlight><div style=background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1> 1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2> 2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-3> 3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-4> 4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-5> 5</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-6> 6</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-7> 7</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-8> 8</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-9> 9</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-10>10</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-11>11</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-12>12</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-13>13</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-14>14</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-15>15</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-16>16</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-17>17</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-18>18</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-19>19</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-20>20</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-21>21</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-22>22</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-23>23</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-24>24</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#8b008b;font-weight:700>resource</span> <span style=color:#cd5555>&#34;aws_s3_bucket&#34; &#34;tl_s3&#34;</span> {
</span></span><span style=display:flex><span>  bucket = <span style=color:#cd5555>&#34;tl-dataset&#34;</span>
</span></span><span style=display:flex><span>  acl    = <span style=color:#cd5555>&#34;private&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b008b;font-weight:700>versioning</span> {
</span></span><span style=display:flex><span>    enabled = <span style=color:#00688b;font-weight:700>true</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags = {
</span></span><span style=display:flex><span>    Name        = <span style=color:#cd5555>&#34;tl s3&#34;</span>
</span></span><span style=display:flex><span>    Project     = <span style=color:#8b008b;font-weight:700>var</span>.<span style=color:#8b008b;font-weight:700>project_name</span>
</span></span><span style=display:flex><span>    Environment = <span style=color:#8b008b;font-weight:700>var</span>.<span style=color:#8b008b;font-weight:700>project_env</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b008b;font-weight:700>resource</span> <span style=color:#cd5555>&#34;aws_s3_bucket_notification&#34; &#34;tl_bucket_notification&#34;</span> {
</span></span><span style=display:flex><span>  bucket = <span style=color:#8b008b;font-weight:700>aws_s3_bucket</span>.<span style=color:#8b008b;font-weight:700>tl_s3</span>.<span style=color:#8b008b;font-weight:700>id</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b008b;font-weight:700>queue</span> {
</span></span><span style=display:flex><span>    queue_arn     = <span style=color:#8b008b;font-weight:700>aws_sqs_queue</span>.<span style=color:#8b008b;font-weight:700>tl_queue</span>.<span style=color:#8b008b;font-weight:700>arn</span>
</span></span><span style=display:flex><span>    events        = [<span style=color:#cd5555>&#34;s3:ObjectCreated:*&#34;</span>]
</span></span><span style=display:flex><span>    filter_prefix = <span style=color:#cd5555>&#34;datasets/&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>最終團隊只有將自家的 Dataset (800G) 放到 Lustre 上面。這邊提醒一下，Lustre 低消是 <code>1.2TB</code>，所以團隊只有少量的 Dataset 的話，其實不應該使用 Lustre 才對。</p><h2 id=使用-amazon-elastic-file-system>使用 Amazon Elastic File System</h2><p>上述 Lustre 整合 SageMaker 相當成功，也順利將整套訓練模型流程給定下來了。但是由於客戶都在中國境內居多，故將整套 Global AWS 架構，轉移到 AWS China 北京 Region。然而當在建置過程中，直接收到 SageMaker API 噴出底下錯誤訊息</p><blockquote><p>FSx for Lustre is currently not supported in the region cn-north-1 for SageMaker</p></blockquote><p>看到這訊息真的蠻傻眼的，直接開 AWS Web Console 操作看看是否少了哪些功能，結果從 UI 上面是無法選擇使用 File System 功能</p><p><img src=https://i.imgur.com/NfwgEtS.png alt=china></p><p>當下馬上跟 AWS 團隊再次確認是否有支援 Lustre，結果得到的回覆是只有支援 EFS，而 UI 上面不支援使用 EFS，只能透過 API 方式進行串接。後端團隊立馬開始將 Lustre 轉換到 EFS，轉換過程遇到一些設定上的問題，像是底下:</p><blockquote><p>ClientError: Unable to mount file system: fs-0337a79e, directory path: /efs/mtk. File system connection timed out. Please ensure that mount target IP address of file system is reachable and the security groups you associate with file system must allow inbound access on NFS port.</p></blockquote><p>EFS 使用的是 <code>2049/TCP</code> 連接埠，故需要新增底下防火牆，並設定在 EFS 的 Security Group 底下。</p><div class=highlight><div style=background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1> 1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2> 2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3> 3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4> 4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-5> 5</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-6> 6</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-7> 7</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-8> 8</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-9> 9</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-10>10</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-11>11</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-12>12</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-13>13</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#8b008b;font-weight:700>resource</span> <span style=color:#cd5555>&#34;aws_security_group&#34; &#34;efs&#34;</span> {
</span></span><span style=display:flex><span>  name        = <span style=color:#cd5555>&#34;allow_efs&#34;</span>
</span></span><span style=display:flex><span>  description = <span style=color:#cd5555>&#34;Allow EFS inbound traffic&#34;</span>
</span></span><span style=display:flex><span>  vpc_id      = <span style=color:#8b008b;font-weight:700>aws_vpc</span>.<span style=color:#8b008b;font-weight:700>cai</span>.<span style=color:#8b008b;font-weight:700>id</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b008b;font-weight:700>ingress</span> {
</span></span><span style=display:flex><span>    from_port   = <span style=color:#b452cd>2049</span>
</span></span><span style=display:flex><span>    to_port     = <span style=color:#b452cd>2049</span>
</span></span><span style=display:flex><span>    protocol    = <span style=color:#cd5555>&#34;tcp&#34;</span>
</span></span><span style=display:flex><span>    cidr_blocks = [<span style=color:#cd5555>&#34;0.0.0.0/0&#34;</span>]
</span></span><span style=display:flex><span>    description = <span style=color:#cd5555>&#34;allow nfs rule&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>搞定上述網路問題後，又遇到底下問題:</p><blockquote><p>ClientError: Unable to mount file system: fs-0337a79e, directory path: /efs/mtk. No such file or directory: /efs/mtk.</p></blockquote><p>這問題比較好解決，原因是在 Lustre 本身就有提供 mount point 指定在特定的位置，像是 <code>/efs</code> 這位置，而 EFS 本身的 mount point 預設在 <code>/</code>，故只需要在 API 上重新設定即可。API 寫法如下</p><div class=highlight><div style=background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1> 1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2> 2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-3> 3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-4> 4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-5> 5</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-6> 6</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-7> 7</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-8> 8</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-9> 9</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-10>10</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-11>11</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-12>12</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-13>13</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-14>14</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-go data-lang=go><span style=display:flex><span>inputDataConfig = <span style=color:#658b00>append</span>(
</span></span><span style=display:flex><span>  inputDataConfig,
</span></span><span style=display:flex><span>  &amp;sagemaker.Channel{
</span></span><span style=display:flex><span>    ChannelName: aws.<span style=color:#008b45>String</span>(<span style=color:#cd5555>&#34;mtk&#34;</span>),
</span></span><span style=display:flex><span>    DataSource: &amp;sagemaker.DataSource{
</span></span><span style=display:flex><span>      FileSystemDataSource: &amp;sagemaker.FileSystemDataSource{
</span></span><span style=display:flex><span>        DirectoryPath:        aws.<span style=color:#008b45>String</span>(options.FSX.Path),
</span></span><span style=display:flex><span>        FileSystemAccessMode: aws.<span style=color:#008b45>String</span>(sagemaker.FileSystemAccessModeRo),
</span></span><span style=display:flex><span>        FileSystemId:         aws.<span style=color:#008b45>String</span>(options.FSX.ID),
</span></span><span style=display:flex><span>        FileSystemType:       aws.<span style=color:#008b45>String</span>(sagemaker.FileSystemTypeFsxLustre),
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>)
</span></span></code></pre></td></tr></table></div></div><p>搞定上述路徑問題後，又遇到另一個網路問題:</p><blockquote><p>ClientError: Data download failed:Please ensure that the subnet&rsquo;s route table has a route to an S3 VPC endpoint or a NAT device, and both the security groups and the subnet&rsquo;s network ACL allow outbound traffic to S3.</p></blockquote><p>想像 AWS EC2要去存取 AWS S3 的資源，完全沒問題的，而可以成功讀取最主要因素是這台 EC2 是在 <code>Public Subnet</code>，它有權限可以存取 Internet，而 Public Subnet 最主要有 route table 搭配 <a href=https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Internet_Gateway.html>internet gateway</a> 才可以存取 Internet。</p><p>而現在遇到此問題的原因是架構使用的是 <code>Private Subnet</code>，而此 Subnet 是不能存取 Internet 的，這時候就需要使用 S3 VPC endpoints 方式來解決此問題。所以透過設定 S3 VPC Endpoint 方式就可以達成存取 S3 檔案了。</p><div class=highlight><div style=background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-3>3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-4>4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-5>5</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#8b008b;font-weight:700>resource</span> <span style=color:#cd5555>&#34;aws_vpc_endpoint&#34; &#34;s3&#34;</span> {
</span></span><span style=display:flex><span>  vpc_id          = <span style=color:#8b008b;font-weight:700>aws_vpc</span>.<span style=color:#8b008b;font-weight:700>cai</span>.<span style=color:#8b008b;font-weight:700>id</span>
</span></span><span style=display:flex><span>  service_name    = <span style=color:#cd5555>&#34;com.amazonaws.cn-north-1.s3&#34;</span>
</span></span><span style=display:flex><span>  route_table_ids = [<span style=color:#8b008b;font-weight:700>aws_route_table</span>.<span style=color:#8b008b;font-weight:700>cai</span>.<span style=color:#8b008b;font-weight:700>id</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=使用心得>使用心得</h2><p>這邊得到一個關鍵的結論就是，假設團隊真的要在 AWS China 進行建置的話，在測試 Gloabl AWS 同時也需要進到 China 看看是否有相同的功能不然到時候整套流程會修改蠻大一部分，好在這次只是遇到 AWS Lustre 轉換到 AWS EFS 而已。</p><p>另外在建置整套 AWS 環境時，需要對網路有一定的概念，還有防火牆，團隊針對權限部分設定的非常嚴謹，沒有用到的權限一率拔掉，或者是在 IAM 上面權限是慢慢打開，而不是一次全部開放。</p><h2 id=參考連結>參考連結</h2><ul><li><a href=https://aws.amazon.com/cn/blogs/china/use-amazon-fsx-for-lustre-and-amazon-efs-as-data-source-to-speed-up-amazon-sagemaker-training/>使用 Amazon FSx for Lustre 和 Amazon EFS 作数据源加快 Amazon Sagemaker 训练</a></li><li><a href=https://docs.aws.amazon.com/efs/latest/ug/installing-amazon-efs-utils.html#installing-other-distro>Installing the Amazon EFS client on other Linux distributions</a></li><li><a href=https://docs.aws.amazon.com/sagemaker/latest/dg/your-algorithms-containers-inference-private.html>Use a Private Docker Registry for Real-Time Inference Containers</a></li><li><a href=https://tomgregory.com/when-to-use-an-aws-s3-vpc-endpoint/>When to use an AWS S3 VPC endpoint</a></li></ul><div class=blog-tags><a href=https://blog.wu-boy.com/tags/sagemaker/>sagemaker</a>&nbsp;
<a href=https://blog.wu-boy.com/tags/golang/>golang</a>&nbsp;
<a href=https://blog.wu-boy.com/tags/fsx/>FSx</a>&nbsp;
<a href=https://blog.wu-boy.com/tags/lustre/>Lustre</a>&nbsp;
<a href=https://blog.wu-boy.com/tags/efs/>EFS</a>&nbsp;
<a href=https://blog.wu-boy.com/tags/terraform/>terraform</a>&nbsp;</div><hr><section id=social-share><div class="list-inline footer-links"><div class=share-box aria-hidden=true><ul class=share><li><a href="//twitter.com/share?url=https%3a%2f%2fblog.wu-boy.com%2f2021%2f09%2fspeed-up-amazon-sagemaker-training-using-efs-or-fsx-lustre%2f&text=%e7%94%a8%20AWS%20EFS%20%e6%88%96%20FSx%20Lustre%20%e5%8a%a0%e9%80%9f%20Sagemaker%20AI%20%e6%a8%a1%e5%9e%8b%e8%a8%93%e7%b7%b4&via=appleboy" target=_blank title="Share on Twitter"><i class="fab fa-twitter"></i></a></li><li><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.wu-boy.com%2f2021%2f09%2fspeed-up-amazon-sagemaker-training-using-efs-or-fsx-lustre%2f" target=_blank title="Share on Facebook"><i class="fab fa-facebook"></i></a></li><li><a href="//reddit.com/submit?url=https%3a%2f%2fblog.wu-boy.com%2f2021%2f09%2fspeed-up-amazon-sagemaker-training-using-efs-or-fsx-lustre%2f&title=%e7%94%a8%20AWS%20EFS%20%e6%88%96%20FSx%20Lustre%20%e5%8a%a0%e9%80%9f%20Sagemaker%20AI%20%e6%a8%a1%e5%9e%8b%e8%a8%93%e7%b7%b4" target=_blank title="Share on Reddit"><i class="fab fa-reddit"></i></a></li><li><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fblog.wu-boy.com%2f2021%2f09%2fspeed-up-amazon-sagemaker-training-using-efs-or-fsx-lustre%2f&title=%e7%94%a8%20AWS%20EFS%20%e6%88%96%20FSx%20Lustre%20%e5%8a%a0%e9%80%9f%20Sagemaker%20AI%20%e6%a8%a1%e5%9e%8b%e8%a8%93%e7%b7%b4" target=_blank title="Share on LinkedIn"><i class="fab fa-linkedin"></i></a></li><li><a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fblog.wu-boy.com%2f2021%2f09%2fspeed-up-amazon-sagemaker-training-using-efs-or-fsx-lustre%2f&title=%e7%94%a8%20AWS%20EFS%20%e6%88%96%20FSx%20Lustre%20%e5%8a%a0%e9%80%9f%20Sagemaker%20AI%20%e6%a8%a1%e5%9e%8b%e8%a8%93%e7%b7%b4" target=_blank title="Share on StumbleUpon"><i class="fab fa-stumbleupon"></i></a></li><li><a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fblog.wu-boy.com%2f2021%2f09%2fspeed-up-amazon-sagemaker-training-using-efs-or-fsx-lustre%2f&description=%e7%94%a8%20AWS%20EFS%20%e6%88%96%20FSx%20Lustre%20%e5%8a%a0%e9%80%9f%20Sagemaker%20AI%20%e6%a8%a1%e5%9e%8b%e8%a8%93%e7%b7%b4" target=_blank title="Share on Pinterest"><i class="fab fa-pinterest"></i></a></li></ul></div></div></section><h4 class=see-also>See also</h4><ul><li><a href=/2022/09/dependency-injection-in-go/>用 Google 團隊推出的 Wire 工具解決 Dependency Injection</a></li><li><a href=/2022/08/three-grpc-testing-tool/>三種好用的 gRPC 測試工具</a></li><li><a href=/2022/07/gatus-system-architecture/>監控服務 Gatus 系統架構</a></li><li><a href=/2022/07/setup-and-teardown-with-unit-testing-in-golang/>在 Go 語言測試使用 Setup 及 Teardown</a></li><li><a href=/2022/06/refactor-worker-pool-source-code/>優化重構 Worker Pool 程式碼</a></li><li><a href=/2022/06/reuse-the-bytes-buffer-in-go/>在 Go 語言內使用 bytes.Buffer 注意事項</a></li><li><a href=/2022/05/read-data-from-channel-in-go/>用 10 分鐘了解 Go 語言如何從 Channel 讀取資料</a></li><li><a href=/2022/04/simple-publish-subscribe-pattern-in-golang/>用 Go 語言實現 Pub-Sub 模式</a></li><li><a href=/2022/04/new-package-graceful-shutdown-in-golang/>Go 語言實作 Graceful Shutdown 套件</a></li><li><a href=/2022/04/grant-access-to-user-specific-folders-in-amazone-s3-bucket/>使用 AWS IAM Policy 設定 S3 Bucket 底下特定目錄權限</a></li></ul></article><ul class="pager blog-pager"><li class=previous><a href=https://blog.wu-boy.com/2021/08/drone-license/ data-toggle=tooltip data-placement=top title="開源專案 Drone CI/CD 平台真的免費嗎？">&larr; Previous Post</a></li><li class=next><a href=https://blog.wu-boy.com/2021/09/%E4%B8%AD%E6%AD%A3%E8%A5%BF%E8%B7%AF%E5%BF%85%E5%90%83%E7%BE%8E%E9%A3%9F-%E9%B4%A8%E8%82%89%E9%BA%B5-%E8%82%89%E7%B5%B2%E7%82%92%E9%A3%AF/ data-toggle=tooltip data-placement=top title="[竹北美食] 中正西路必吃美食 - 鴨肉麵 + 肉絲炒飯">Next Post &rarr;</a></li></ul><div class=disqus-comments><button id=show-comments class="btn btn-default" type=button>Show <span class=disqus-comment-count data-disqus-url=https://blog.wu-boy.com/2021/09/speed-up-amazon-sagemaker-training-using-efs-or-fsx-lustre>comments</span></button><div id=disqus_thread></div><script type=text/javascript>var disqus_config=function(){this.page.url="https://blog.wu-boy.com/2021/09/speed-up-amazon-sagemaker-training-using-efs-or-fsx-lustre"}</script></div></div></div></div><footer class=post-footer><div class=container><div class=row><div class="col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=mailto:appleboy.tw@gmail.com title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://www.facebook.com/appleboy46 title=Facebook><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/appleboy title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://gitlab.com/appleboy title=GitLab><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-gitlab fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://bitbucket.org/appleboy title=Bitbucket><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-bitbucket fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://twitter.com/appleboy title=Twitter><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://linkedin.com/in/appleboy title=LinkedIn><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://www.youtube.com/channel/UCLCZJ9d_I7UJP2bpXpge8KA title=Youtube><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-youtube fa-stack-1x fa-inverse"></i></span></a></li><li><a href title=RSS><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted"><a href=https://blog.wu-boy.com>Appleboy</a>
&nbsp;&bull;&nbsp;&copy;
2023
&nbsp;&bull;&nbsp;
<a href=https://blog.wu-boy.com>小惡魔 - AppleBOY</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.109.0</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script>
<script src=https://blog.wu-boy.com/js/main.js></script>
<script>(function(){var t,n="003841896160749976666:l9i5hqttpqi",e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://cse.google.com/cse.js?cx="+n,t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>$(function(){$("#show-comments").on("click",function(){var e="appleboy48";(function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="//"+e+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)})(),$(this).hide()})})</script><script id=dsq-count-scr src=//appleboy48.disqus.com/count.js async></script><div class=back-to-top id=back-to-top><i class="fas fa-angle-double-up"></i></div></body></html>
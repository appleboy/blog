---
title: '[Apache] 防盜連，抓圖'
author: appleboy
type: post
date: 2007-01-19T02:59:14+00:00
url: /2007/01/apache-防盜連，抓圖-2/
views:
  - 4604
bot_views:
  - 1390
dsq_thread_id:
  - 252062250
categories:
  - apache
  - FreeBSD
  - Linux
  - Network
  - windows

---
目前管理 [國史館-台灣文獻館][1]，幾台檔案伺服器 裝了 快 1000萬的數位話檔案，如果將來對外開放，將會造成大量被下載 所以我列了下面幾個保護裝置，目前用在館內，我弄了幾個軟體去下載，果然已經被阻擋了 網頁伺服器要支援REWRITE功能 <!--more--> 1.直接不給連 RewriteEngine on RewriteCond %{HTTP\_REFERER} !^$ RewriteCond %{HTTP\_REFERER} !^http://(www\.)?mydomain.com/.\*$ [NC] RewriteRule \.(gif|jpg)$ - [F] 2.給你其他小檔案 RewriteEngine on RewriteCond %{HTTP\_REFERER} !^$ RewriteCond %{HTTP\_REFERER} !^http://(www\.)?mydomain.com/.\*$ [NC] RewriteRule \.(gif|jpg)$ http://www.mydomain.com/badimage.gif [R,L] 3.擋離線瀏覽器 RewriteEngine on # (testing purposes) RewriteCond %{HTTP\_USER\_AGENT} ^Mozilla\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^FAST\-WebCrawler\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^ia\_archiver\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Dart\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Pockey\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^NetMechanic\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^SuperBot\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^QRVA\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebMiner\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebCopier\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebDownloader\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Web\ Downloader\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebMirror\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Offline\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebZIP\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebReaper\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Anarchie\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Mass\ Down\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Slurp\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^BlackWidow\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebStripper\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Wget\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebHook\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Scooter\* [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Teleport\* RewriteRule ^.\*$ /pbourke/errors/robots.html [L] 4.不過我不想用這個，因為離線瀏覽器的名稱可以隨便給 還是擋離線軟體，不知道有沒有重複 RewriteEngine On RewriteCond %{HTTP\_USER\_AGENT} ^BlackWidow [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Bot\ mailto:craftbot@yahoo.com [OR] RewriteCond %{HTTP\_USER\_AGENT} ^ChinaClaw [OR] RewriteCond %{HTTP\_USER\_AGENT} ^DISCo [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Download\ Demon [OR] RewriteCond %{HTTP\_USER\_AGENT} ^eCatch [OR] RewriteCond %{HTTP\_USER\_AGENT} ^EirGrabber [OR] RewriteCond %{HTTP\_USER\_AGENT} ^EmailSiphon [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Express\ WebPictures [OR] RewriteCond %{HTTP\_USER\_AGENT} ^ExtractorPro [OR] RewriteCond %{HTTP\_USER\_AGENT} ^EyeNetIE [OR] RewriteCond %{HTTP\_USER\_AGENT} ^FlashGet [OR] RewriteCond %{HTTP\_USER\_AGENT} ^GetRight [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Go!Zilla [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Go-Ahead-Got-It [OR] RewriteCond %{HTTP\_USER\_AGENT} ^GrabNet [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Grafula [OR] RewriteCond %{HTTP\_USER\_AGENT} ^HMView [OR] RewriteCond %{HTTP\_USER\_AGENT} ^HTTrack [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Image\ Stripper [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Image\ Sucker [OR] RewriteCond %{HTTP\_USER\_AGENT} ^InterGET [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Internet\ Ninja [OR] RewriteCond %{HTTP\_USER\_AGENT} ^JetCar [OR] RewriteCond %{HTTP\_USER\_AGENT} ^JOC\ Web\ Spider [OR] RewriteCond %{HTTP\_USER\_AGENT} ^larbin [OR] RewriteCond %{HTTP\_USER\_AGENT} ^LeechFTP [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Mass\ Downloader [OR] RewriteCond %{HTTP\_USER\_AGENT} ^MIDown\ tool [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Mister\ PiX [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Navroad [OR] RewriteCond %{HTTP\_USER\_AGENT} ^NearSite [OR] RewriteCond %{HTTP\_USER\_AGENT} ^NetAnts [OR] RewriteCond %{HTTP\_USER\_AGENT} ^NetSpider [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Net\ Vampire [OR] RewriteCond %{HTTP\_USER\_AGENT} ^NetZIP [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Octopus [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Offline\ Explorer [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Offline\ Navigator [OR] RewriteCond %{HTTP\_USER\_AGENT} ^PageGrabber [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Papa\ Foto [OR] RewriteCond %{HTTP\_USER\_AGENT} ^pcBrowser [OR] RewriteCond %{HTTP\_USER\_AGENT} ^RealDownload [OR] RewriteCond %{HTTP\_USER\_AGENT} ^ReGet [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Siphon [OR] RewriteCond %{HTTP\_USER\_AGENT} ^SiteSnagger [OR] RewriteCond %{HTTP\_USER\_AGENT} ^SmartDownload [OR] RewriteCond %{HTTP\_USER\_AGENT} ^SuperBot [OR] RewriteCond %{HTTP\_USER\_AGENT} ^SuperHTTP [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Surfbot [OR] RewriteCond %{HTTP\_USER\_AGENT} ^tAkeOut [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Teleport\ Pro [OR] RewriteCond %{HTTP\_USER\_AGENT} ^VoidEYE [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Web\ Image\ Collector [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Web\ Sucker [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebAuto [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebCopier [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebFetch [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebReaper [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebSauger [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Website\ eXtractor [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebStripper [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebWhacker [OR] RewriteCond %{HTTP\_USER\_AGENT} ^WebZIP [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Wget [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Widow [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Xaldon\ WebSpider [OR] RewriteCond %{HTTP\_USER\_AGENT} ^Zeus RewriteRule ^.\*$ /error.php [L] RewriteRule ^.\*$ http://www.site-where-you-want-to-send-the-bot [L,R] 另外一種方法 SetEnvIfNoCase Referer "^http://220\.134\.208\.55/" local\_ref=1 SetEnvIfNoCase Referer "^http://hi17168\.calling\.com\.tw/" local_ref=1 <FilesMatch "\.(txt|doc|gif|jpg|mp3)"> Order Allow,Deny Allow from env=local_ref Allow from 127.0.0.1 </FilesMatch> 


[ http://www.webmasterworld.com/forum13/687-4-10.htm][2] Alias /old\_image "D:\Big\_img" <Directory "D:\Big\_img"> Options -Indexes SetEnvIfNoCase Referer "^http://192\.168\.100\.244/old\_dar/" local\_ref=1 SetEnvIfNoCase Referer "^http://163\.29\.208\.22/old\_dar/" local_ref=1 <FilesMatch "\.(jpg|jpeg|gif|png|bmp)"> Order Allow,Deny Allow from env=local_ref Allow from 127.0.0.1 Allow from 192.168.100.244 Allow from 163.29.208.22 </FilesMatch> </Directory> 參考： [網站一][3] [網站二][2]

 [1]: http://www.th.gov.tw
 [2]: http://www.webmasterworld.com/forum13/687-4-10.htm
 [3]: http://twpug.net/modules/newbb/viewtopic.php?topic_id=579&forum=22
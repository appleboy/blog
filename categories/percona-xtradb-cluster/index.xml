<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Percona XtraDB Cluster on 小惡魔 - AppleBOY</title><link>https://blog.wu-boy.com/categories/percona-xtradb-cluster/</link><description>Recent content in Percona XtraDB Cluster on 小惡魔 - AppleBOY</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><managingEditor>appleboy.tw@gmail.com (Appleboy)</managingEditor><webMaster>appleboy.tw@gmail.com (Appleboy)</webMaster><lastBuildDate>Sat, 20 Jun 2015 07:31:46 +0000</lastBuildDate><atom:link href="https://blog.wu-boy.com/categories/percona-xtradb-cluster/index.xml" rel="self" type="application/rss+xml"/><item><title>優化 Percona XtraDB Cluster for write hotspots</title><link>https://blog.wu-boy.com/2015/06/optimizing-percona-xtradb-cluster-for-write-hotspots/</link><pubDate>Sat, 20 Jun 2015 07:31:46 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2015/06/optimizing-percona-xtradb-cluster-for-write-hotspots/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/12023069753/" title="percona by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm4.staticflickr.com/3820/12023069753_de60d0c86d_m.jpg?resize=240%2C234&amp;#038;ssl=1" alt="percona" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>在 &lt;a href="https://www.percona.com/blog">Percona Blog&lt;/a> 上看到這篇 &lt;a href="https://www.percona.com/blog/2015/06/03/optimizing-percona-xtradb-cluster-write-hotspots/">Optimizing Percona XtraDB Cluster for write hotspots&lt;/a> 優化多重寫入 MySQL 的狀況，舉例來說，要計算 global counter 的時候，就會遇到很頻繁的寫入 (write hotspot)，目前是不能同時寫入資料到同一個 record，會造成 performance 降低，所以大家開始導入 &lt;a href="https://www.percona.com/software/percona-xtradb-cluster">Percona XtraDB Cluster&lt;/a> 來解決同時間寫入到同一個 record，大家都認為，搞了三台 Percona Server，可以將寫入的動作分散到其他兩台，就不會遇到 Lock 問題，但是實際上根本就不是這樣。&lt;/p></description></item><item><title>在 Debian 安裝 Percona Xtradb Cluster 5.5.34 注意事項</title><link>https://blog.wu-boy.com/2014/07/install-percona-xtradb-cluster-5-5-34-tips/</link><pubDate>Fri, 04 Jul 2014 02:29:40 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/07/install-percona-xtradb-cluster-5-5-34-tips/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/12023069753/" title="percona by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm4.staticflickr.com/3820/12023069753_de60d0c86d_m.jpg?resize=240%2C234&amp;#038;ssl=1" alt="percona" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>最近幫公司安裝新的三台機器，全部上 &lt;a href="https://www.debian.org/">Debian&lt;/a> 7.5 Server 版本，統一安裝 &lt;a href="http://www.percona.com/software/percona-xtradb-cluster">Percona Xtradb Cluster&lt;/a> 最新版本 5.5.37。設定完第一台 Node，並且透過底下指令 boot up 成第一台 PXC。&lt;/p>
&lt;div>
&lt;pre class="brush: bash; title: ; notranslate" title="">$ /etc/init.d/mysql bootstrap-pxc&lt;/pre>
&lt;/div>
&lt;p>後續第二台要啟動跟第一台進行 SST，寫到一半直接噴底下錯誤訊息&lt;/p>
&lt;blockquote>
&lt;p>WSREP_SST: [ERROR] Cleanup after exit with status:32 (20140702 10:57:28.004) WSREP_SST: [INFO] Removing the sst_in_progress file (20140702 10:57:28.006) 140702 10:57:28 [ERROR] WSREP: Process completed with error: wsrep_sst_xtrabackup &amp;ndash;role &amp;lsquo;joiner&amp;rsquo; &amp;ndash;address &amp;lsquo;192.168.1.101&amp;rsquo; &amp;ndash;auth &amp;lsquo;xxxxx:xxxxxx&amp;rsquo; &amp;ndash;datadir &amp;lsquo;/var/lib/mysql/&amp;rsquo; &amp;ndash;defaults-file &amp;lsquo;/etc/mysql/my.cnf&amp;rsquo; &amp;ndash;parent &amp;lsquo;16042&amp;rsquo;: 32 (Broken pipe) 140702 10:57:28 [ERROR] WSREP: Failed to read uuid:seqno from joiner script. 140702 10:57:28 [ERROR] WSREP: SST failed: 32 (Broken pipe)&lt;/p>
&lt;/blockquote></description></item><item><title>免費下載 Percona MySQL eBooks</title><link>https://blog.wu-boy.com/2014/05/free-download-percona-mysql-ebooks/</link><pubDate>Fri, 09 May 2014 02:24:05 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/05/free-download-percona-mysql-ebooks/</guid><description>玩 MySQL 的一定知道 Percona，這次 Percona MySQL 推出免費電子書，電子書內容是從 MySQLPerformanceBlog 裡面精心挑選文章收錄，文章內容也幾乎都是 MySQL 專家寫出來的，電子書內容包含了MySQL server, Percona Server, Percona XtraDB Cluster, MySQL performance, and MySQL troubleshooting，所有的電子書都是免費下載。
How to find bugs in MySQL InnoDB Full Text Search in MySQL 5.6 InnoDB Performance Optimization Percona XtraDB Cluster 5.6 Percona XtraDB Cluster 更多主題可以直接參考 MySQL eBooks</description></item><item><title>OSDC 2014 Talk: Introduction to Percona XtraDB Cluster and HAProxy</title><link>https://blog.wu-boy.com/2014/04/osdc-2014-talk-introduction-to-percona-xtradb-cluster-and-haproxy/</link><pubDate>Sat, 12 Apr 2014 03:26:19 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/04/osdc-2014-talk-introduction-to-percona-xtradb-cluster-and-haproxy/</guid><description>&lt;p>&lt;strong>2014.05.07 OSDC 影片檔出爐&lt;/strong>&lt;/p>
&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/12023069753/" title="percona by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm4.staticflickr.com/3820/12023069753_de60d0c86d_m.jpg?resize=240%2C234&amp;#038;ssl=1" alt="percona" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>很高興可以參加今年 &lt;a href="http://osdc.tw/2014/">2014 OSDC&lt;/a>，投了一篇 &lt;a href="http://osdc.tw/program/2014-day2-10.html#content">Introduction to Percona XtraDB Cluster and HAProxy&lt;/a>，主要介紹 &lt;a href="http://www.percona.com/software/percona-xtradb-cluster">Percona XtraDB Cluster&lt;/a> 這套 open source 軟體搭配前端 &lt;a href="http://haproxy.1wt.eu/">HAProxy&lt;/a>，底下是 Slides&lt;/p></description></item><item><title>Percona Cloud Tools for MySQL 介紹及安裝</title><link>https://blog.wu-boy.com/2014/03/quick-installation-for-percona-cloud-tools-for-mysql/</link><pubDate>Thu, 06 Mar 2014 07:53:05 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/03/quick-installation-for-percona-cloud-tools-for-mysql/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/12023069753/" title="percona by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm4.staticflickr.com/3820/12023069753_de60d0c86d_m.jpg?resize=240%2C234&amp;#038;ssl=1" alt="percona" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>&lt;a href="https://www.percona.com">Percona&lt;/a> 去年推出一套 &lt;a href="https://cloud.percona.com">Cloud Tools for MySQL&lt;/a>，藉由這套雲端服務可以幫忙分析 MySQL 系統內全部 Slow Query，並且計算出時間，畫出統計圖，此套系統目前還在 Beta 版，並且有些限制，只能開 3 個 organizations，每個 organizations 只能有 5 agents，最後資料只會保留 8 天，超過就會清除。這套系統後端是由 &lt;a href="http://golang.org/">GO Language&lt;/a> 完成，前端則是由 &lt;a href="http://angularjs.org/">AngularJS&lt;/a> 串起來，上個月 Percona 還在 &lt;a href="http://www.mysqlperformanceblog.com">MySQL Performance Blog&lt;/a> 徵求 &lt;a href="http://www.mysqlperformanceblog.com/2014/01/20/percona-hiring-go-back-end-engineer/">GO 的開發者&lt;/a>，可見 Percona 也看好此服務，大膽使用 Google 推的 GO Language。&lt;/p></description></item><item><title>Percona XtraDB Cluster 5.6 找合適 IST Donor</title><link>https://blog.wu-boy.com/2014/02/percona-xtradb-cluster-5-6-ist-and-sst/</link><pubDate>Sun, 09 Feb 2014 12:55:55 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/02/percona-xtradb-cluster-5-6-ist-and-sst/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/12023069753/" title="percona by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm4.staticflickr.com/3820/12023069753_de60d0c86d_m.jpg?resize=240%2C234&amp;#038;ssl=1" alt="percona" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>Gcache 是用來紀錄 &lt;a href="http://www.mysql.com/">MySQL&lt;/a> 最近所使用的 SQL Command，其本身是佔用記憶體空間，大小可以由 &lt;code>wsrep_provider_options&lt;/code> 定義，如果有任何 MySQL Node 重新啟動，那麼可以經由 Live Node 內的 Gcache 將尚未同步的資料補上，同步資料的方式分為兩種一種為 IST(Incremental State Transfer) 另一種為 SST(State Snapshot Transfer)，但是同步資料時，管理者無法決定同步方式。先來看看 Gcache 一些特性&lt;/p>
&lt;ul>
&lt;li>node 重新啟動，Gcache 資料會全部消失&lt;/li>
&lt;li>Gcache 大小為固定，如果超過大小，則回刪除最早資料&lt;/li>
&lt;li>選擇 Donor node 會直接忽略 Gcache 狀態&lt;/li>
&lt;li>Node 重新啟動，需要同步的資料並非在指定 Node Gcahe 內，則會啟動 SST 同步&lt;/li>
&lt;li>到目前版本為止，沒有任何方式可以知道 Gcache 狀態&lt;/li>
&lt;/ul>
&lt;p>根據以上特性可以知道，當 Node 重新啟動，很容易就執行 SST 模式，舉例子來說，當有 Node crashed 超過一個晚上，你要如何知道其他 Node 內的 Gcache 資料大於需要同步的資料量？或者是當 Cluster 內只有兩台機器，那重新啟動任何一台 Node 都會是跑 SST 同步。&lt;/p></description></item><item><title>啟動 Percona XtraDB Cluster 注意事項</title><link>https://blog.wu-boy.com/2014/01/start-percona-xtradb-cluster-tips/</link><pubDate>Mon, 20 Jan 2014 06:50:45 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/01/start-percona-xtradb-cluster-tips/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/12023069753/" title="percona by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm4.staticflickr.com/3820/12023069753_de60d0c86d_m.jpg?resize=240%2C234&amp;#038;ssl=1" alt="percona" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>在 &lt;a href="http://www.percona.com/software/percona-xtradb-cluster">Percona XtraDB Cluster&lt;/a> 推出 &lt;a href="http://www.percona.com/doc/percona-xtradb-cluster/5.5/release-notes/Percona-XtraDB-Cluster-5.5.28.html">5.5.28&lt;/a> 以前，最簡單的啟動方式就是打開 &lt;code>my.cnf&lt;/code> 設定 &lt;code>wsrep_urls&lt;/code> 在 &lt;code>[mysqld_safe]&lt;/code> section 內。假設我們有三台 Node 分別為底下 IP:&lt;/p>
&lt;ul>
&lt;li>node1 = 192.168.1.100&lt;/li>
&lt;li>node2 = 192.168.1.101&lt;/li>
&lt;li>node3 = 192.168.1.102&lt;/li>
&lt;/ul></description></item><item><title>Percona XtraDB Cluster 搭配 HAProxy</title><link>https://blog.wu-boy.com/2014/01/percona-xtradb-cluster-reference-architecture-with-haproxy/</link><pubDate>Sun, 19 Jan 2014 13:02:47 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/01/percona-xtradb-cluster-reference-architecture-with-haproxy/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/12023069753/" title="percona by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm4.staticflickr.com/3820/12023069753_de60d0c86d_m.jpg?resize=240%2C234&amp;#038;ssl=1" alt="percona" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>本篇文章紀錄安裝 &lt;a href="http://www.percona.com/software/percona-xtradb-cluster">Percona XtraDB Cluster&lt;/a> (簡稱 PXC) 及搭配 &lt;a href="http://haproxy.1wt.eu/">HAProxy&lt;/a> 做分散流量系統，其實在業界已經很常看到 HAProxy + MySQL Cluster Database 解決方案，HAProxy 幫您解決負載平衡，並且偵測系統是否存活，管理者也就不用擔心 MySQL 服務是否會掛掉。本篇會著重於 HAProxy 設定部份，並且紀錄每一步安裝步驟。之前本作者寫過一篇 &lt;a href="http://blog.wu-boy.com/2013/03/galera-cluster-for-mysql-multi-master-replication/">Galera Cluster for MySQL Multi-master Replication&lt;/a>，也可以參考。今天測試系統都會以 &lt;a href="http://www.centos.org/">CentOS&lt;/a> 為主，各位讀者可以直接開 &lt;a href="http://aws.amazon.com/ec2/">Amazone EC2&lt;/a> 來測試，測試完成再關閉即可。&lt;/p></description></item><item><title>Percona XtraDB Server 出現 read only issue</title><link>https://blog.wu-boy.com/2014/01/percona-xtradb-server-read-only-issue/</link><pubDate>Thu, 16 Jan 2014 08:25:42 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/01/percona-xtradb-server-read-only-issue/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/8171305355/" title="mysql_logo by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm9.staticflickr.com/8488/8171305355_7fb578fdc9.jpg?w=300&amp;#038;ssl=1" alt="mysql_logo" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>最近在整理 &lt;a href="http://www.percona.com/software/percona-server">Percona XtraDB Server&lt;/a> 將 Read Write 全部拆開，寫入部份只開一台 Node，讀取機器 Replica 則是越多越好，當然如果預計 write 都不會有任何 conflict 的話，那就不用拆開，read write 都可以在同一台即可，拆開的目的要解決 &lt;code>Innodb transaction locking&lt;/code> 問題。今天遇到的是將機器讀寫都放在同一台，然後同時多台 Master 架構，結果跑在 &lt;a href="http://www.codeigniter.org.tw/">CodeIgniter&lt;/a> 上面出現底下錯誤訊息&lt;/p>
&lt;blockquote>
&lt;p>The MySQL server is running with the &amp;ndash;read-only option so it cannot execute this statement&lt;/p>
&lt;/blockquote></description></item><item><title>Sysbench 測試 Percona XtraDB Server 效能</title><link>https://blog.wu-boy.com/2014/01/sysbench-test-percona-xtradb-server-performance/</link><pubDate>Wed, 15 Jan 2014 11:00:15 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2014/01/sysbench-test-percona-xtradb-server-performance/</guid><description>&lt;div style="margin:0 auto; text-align:center">
&lt;a href="https://www.flickr.com/photos/appleboy/8171305355/" title="mysql_logo by appleboy46, on Flickr">&lt;img src="https://i1.wp.com/farm9.staticflickr.com/8488/8171305355_7fb578fdc9.jpg?w=300&amp;#038;ssl=1" alt="mysql_logo" data-recalc-dims="1" />&lt;/a>
&lt;/div>
&lt;p>今天拿 &lt;a href="https://launchpad.net/sysbench">MySQL benchmark tool - Sysbench&lt;/a> 來測試看看 &lt;a href="http://www.percona.com/software/percona-server">Percona XtraDB Server&lt;/a> + &lt;a href="http://haproxy.1wt.eu/">Haproxy&lt;/a> 效能如何，實驗主機是執行在 &lt;a href="http://www.centos.org/">CentOS&lt;/a> 6.4 版本，記憶體 128 G，在 CentOS 本身用 Yum 安裝 Sysbench 時，內建的版本為 0.4.12，單機測試 MySQL 效能不會出現任何錯誤，但是只要是透過 Haproxy，並且有兩台以上的 Server，就會噴出底下錯誤訊息:&lt;/p>
&lt;blockquote>
&lt;p>ALERT: failed to execute mysql_stmt_execute(): Err1317 Query execution was interrupted&lt;/p>
&lt;/blockquote></description></item></channel></rss>
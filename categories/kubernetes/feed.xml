<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Kubernetes on 小惡魔 - AppleBOY</title><link>https://blog.wu-boy.com/categories/kubernetes/</link><description>Recent content in Kubernetes on 小惡魔 - AppleBOY</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><managingEditor>appleboy.tw@gmail.com (Appleboy)</managingEditor><webMaster>appleboy.tw@gmail.com (Appleboy)</webMaster><lastBuildDate>Tue, 05 Jun 2018 02:36:11 +0000</lastBuildDate><atom:link href="https://blog.wu-boy.com/categories/kubernetes/feed.xml" rel="self" type="application/rss+xml"/><item><title>Drone 搭配 Kubernetes 部署 Go 語言項目</title><link>https://blog.wu-boy.com/2018/06/drone-kubernetes-with-golang/</link><pubDate>Tue, 05 Jun 2018 02:36:11 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2018/06/drone-kubernetes-with-golang/</guid><description>&lt;p>&lt;a href="https://www.flickr.com/photos/appleboy/27678088297/in/dateposted-public/" title="Screen Shot 2018-06-04 at 9.19.46 AM">&lt;img src="https://i1.wp.com/farm2.staticflickr.com/1738/27678088297_1c6fe64e86_z.jpg?w=840&amp;#038;ssl=1" alt="Screen Shot 2018-06-04 at 9.19.46 AM" data-recalc-dims="1" />&lt;/a>&lt;/p>
&lt;p>在之前寫過一篇『&lt;a href="https://blog.wu-boy.com/2017/10/upgrade-kubernetes-container-using-drone/">Drone 搭配 Kubernetes 升級應用程式版本&lt;/a>』，裡面內容最主要介紹 &lt;a href="https://github.com/honestbee">honestbee&lt;/a> 撰寫的 &lt;a href="https://drone.io">drone&lt;/a> 外掛: &lt;a href="https://github.com/honestbee/drone-kubernetes">drone-kubernetes&lt;/a>，但是此外掛並非用 &lt;a href="https://golang.org">Go 語言&lt;/a>所撰寫，而是用 Shell Script 透過 &lt;code>kubectl set image&lt;/code> 方式來更新專案項目，但是這邊會有幾個缺點，第一點就是假設在 Develop 環境永遠都是吃 master 分支，也就是讀取 Image 的 &lt;code>latest&lt;/code> 標籤，這時候此外掛就無法作用，第二點此外掛無法讀取 kubernetes YAML 檔案，假設專案要修正一個 ENV 值，此外掛也無法及時更新。綜合這兩點因素，只好捨棄此外掛，而本篇會帶給大家另一個用 Go 語言所撰寫的外掛，是由 &lt;a href="https://github.com/Sh4d1">@Sh4d1&lt;/a> 所開發的&lt;a href="https://github.com/Sh4d1/drone-kubernetes/">項目&lt;/a>，用法相當容易，底下會一步一步教大家如何部署 Go 語言項目。&lt;/p></description></item><item><title>Drone 搭配 Kubernetes 升級應用程式版本</title><link>https://blog.wu-boy.com/2017/10/upgrade-kubernetes-container-using-drone/</link><pubDate>Tue, 10 Oct 2017 16:02:23 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2017/10/upgrade-kubernetes-container-using-drone/</guid><description>&lt;p>&lt;a href="https://www.flickr.com/photos/appleboy/36944908123/in/dateposted-public/" title="Screen Shot 2017-10-10 at 9.22.48 PM">&lt;img src="https://i0.wp.com/farm5.staticflickr.com/4481/36944908123_68ecdb8139_z.jpg?w=840&amp;#038;ssl=1" alt="Screen Shot 2017-10-10 at 9.22.48 PM" data-recalc-dims="1" />&lt;/a>&lt;/p>
&lt;p>本篇要教大家如何透過 &lt;a href="https://github.com/drone/drone">Drone&lt;/a> 搭配 &lt;a href="https://kubernetes.io/">Kubernetes&lt;/a> 自動化升級 App container 版本。為什麼我只說升級 App 版本，而不是升級或調整 K8S Deployment 架構呢 (&lt;code>kubectl apply&lt;/code>)？原因是本篇會圍繞在 &lt;a href="https://github.com/honestbee">honestbee&lt;/a> 撰寫的 drone 外掛: &lt;a href="https://github.com/honestbee/drone-kubernetes">drone-kubernetes&lt;/a>，此外掛是透過 Shell Script 方式搭配 &lt;a href="https://kubernetes.io/docs/user-guide/kubectl-overview/">kubectl&lt;/a> 指令來完成升級 App 版本，可以看到程式原始碼並無用到 &lt;code>kubectl apply&lt;/code> 方式來升級，也並非用 &lt;a href="https://golang.org">Go 語言&lt;/a>搭配 k8s API 所撰寫，所以無法使用 &lt;a href="https://en.wikipedia.org/wiki/YAML">YAML&lt;/a> 方式來進行 Deployment 的升級。本篇講解的範例都可以在 &lt;a href="https://github.com/go-training/drone-nodejs-example">drone-nodejs-example&lt;/a> 內找到。底下指令就是外掛用來搭配 Drone 參數所使用。&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2;">&lt;code>&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-1">&lt;a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-1">1&lt;/a>
&lt;/span>&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-2">&lt;a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-2">2&lt;/a>
&lt;/span>&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-3">&lt;a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-3">3&lt;/a>
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:2;-o-tab-size:2;tab-size:2;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ kubectl &lt;span style="color:#658b00">set&lt;/span> image &lt;span style="color:#cd5555">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#cd5555">&lt;/span> deployment/nginx-deployment &lt;span style="color:#cd5555">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#cd5555">&lt;/span> &lt;span style="color:#00688b">nginx&lt;/span>=nginx:1.9.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>用 Kubernetes 將 Drone CI/CD 架設在 AWS</title><link>https://blog.wu-boy.com/2017/09/drone-on-kubernetes-on-aws/</link><pubDate>Sat, 23 Sep 2017 16:55:33 +0000</pubDate><author>appleboy.tw@gmail.com (Appleboy)</author><guid>https://blog.wu-boy.com/2017/09/drone-on-kubernetes-on-aws/</guid><description>&lt;p>&lt;a href="https://www.flickr.com/photos/appleboy/37237823752/in/dateposted-public/" title="Screen Shot 2017-09-24 at 12.53.39 AM">&lt;img src="https://i0.wp.com/farm5.staticflickr.com/4497/37237823752_68a508e4bb_z.jpg?w=840&amp;#038;ssl=1" alt="Screen Shot 2017-09-24 at 12.53.39 AM" data-recalc-dims="1" />&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/drone/drone">Drone&lt;/a> 是我今年主推的 CI/CD 自架服務，詳細可以參考&lt;a href="https://blog.wu-boy.com/2017/09/why-i-choose-drone-as-ci-cd-tool/">這篇文章&lt;/a>，目前在公司內部團隊使用了一年以上，服務相當穩定。Drone 本身可以透過 &lt;a href="https://github.com/go-training/drone-tutorial">docker-compose 方式&lt;/a>快速在機器上架設完成，但是由於 &lt;a href="https://kubernetes.io/">Kubernetes&lt;/a> 的盛行，大家也希望能透過 Kubernetes 來安裝 Drone 服務。本篇會教大家如何在 AWS 上透過 Kubernetes 安裝完成。Drone 預設使用 &lt;a href="https://www.sqlite.org/">SQLite&lt;/a> 當作資料庫，檔案會直接存放在 &lt;code>/var/lib/drone&lt;/code> 路徑底下，但是容器內不支援寫入，所以必須要要額外掛上空間讓 Drone 可以寫入資料。此篇會以 &lt;a href="https://github.com">GitHub&lt;/a> 認證 + SQLite 來教學。&lt;/p></description></item></channel></rss>